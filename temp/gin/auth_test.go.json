{"children":[],"start":168,"end":3797,"code":"package gin\n\nimport (\n\t\"encoding/base64\"\n\t\"net/http\"\n\t\"net/http/httptest\"\n\t\"testing\"\n\t\"github.com/stretchr/testify/assert\"\n)\n\nfunc TestBasicAuth(t *testing.T) {\n\tpairs := processAccounts(Accounts{\"admin\": \"password\", \"foo\": \"bar\", \"bar\": \"foo\"})\n\tassert.Len(t, pairs, 3)\n\tassert.Contains(t, pairs, authPair{user: \"bar\", value: \"Basic YmFyOmZvbw==\"})\n\tassert.Contains(t, pairs, authPair{user: \"foo\", value: \"Basic Zm9vOmJhcg==\"})\n\tassert.Contains(t, pairs, authPair{user: \"admin\", value: \"Basic YWRtaW46cGFzc3dvcmQ=\"})\n}\nfunc TestBasicAuthFails(t *testing.T) {\n\tassert.Panics(t, func() {\n\t\tprocessAccounts(nil)\n\t})\n\tassert.Panics(t, func() {\n\t\tprocessAccounts(Accounts{\"\": \"password\", \"foo\": \"bar\"})\n\t})\n}\nfunc TestBasicAuthSearchCredential(t *testing.T) {\n\tpairs := processAccounts(Accounts{\"admin\": \"password\", \"foo\": \"bar\", \"bar\": \"foo\"})\n\tuser, found := pairs.searchCredential(authorizationHeader(\"admin\", \"password\"))\n\tassert.Equal(t, \"admin\", user)\n\tassert.True(t, found)\n\tuser, found = pairs.searchCredential(authorizationHeader(\"foo\", \"bar\"))\n\tassert.Equal(t, \"foo\", user)\n\tassert.True(t, found)\n\tuser, found = pairs.searchCredential(authorizationHeader(\"bar\", \"foo\"))\n\tassert.Equal(t, \"bar\", user)\n\tassert.True(t, found)\n\tuser, found = pairs.searchCredential(authorizationHeader(\"admins\", \"password\"))\n\tassert.Empty(t, user)\n\tassert.False(t, found)\n\tuser, found = pairs.searchCredential(authorizationHeader(\"foo\", \"bar \"))\n\tassert.Empty(t, user)\n\tassert.False(t, found)\n\tuser, found = pairs.searchCredential(\"\")\n\tassert.Empty(t, user)\n\tassert.False(t, found)\n}\nfunc TestBasicAuthAuthorizationHeader(t *testing.T) {\n\tassert.Equal(t, \"Basic YWRtaW46cGFzc3dvcmQ=\", authorizationHeader(\"admin\", \"password\"))\n}\nfunc TestBasicAuthSucceed(t *testing.T) {\n\taccounts := Accounts{\"admin\": \"password\"}\n\trouter := New()\n\trouter.Use(BasicAuth(accounts))\n\trouter.GET(\"/login\", func(c *Context) {\n\t\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n\t})\n\tw := httptest.NewRecorder()\n\treq, _ := http.NewRequest(\"GET\", \"/login\", nil)\n\treq.Header.Set(\"Authorization\", authorizationHeader(\"admin\", \"password\"))\n\trouter.ServeHTTP(w, req)\n\tassert.Equal(t, http.StatusOK, w.Code)\n\tassert.Equal(t, \"admin\", w.Body.String())\n}\nfunc TestBasicAuth401(t *testing.T) {\n\tcalled := false\n\taccounts := Accounts{\"foo\": \"bar\"}\n\trouter := New()\n\trouter.Use(BasicAuth(accounts))\n\trouter.GET(\"/login\", func(c *Context) {\n\t\tcalled = true\n\t\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n\t})\n\tw := httptest.NewRecorder()\n\treq, _ := http.NewRequest(\"GET\", \"/login\", nil)\n\treq.Header.Set(\"Authorization\", \"Basic \"+base64.StdEncoding.EncodeToString([]byte(\"admin:password\")))\n\trouter.ServeHTTP(w, req)\n\tassert.False(t, called)\n\tassert.Equal(t, http.StatusUnauthorized, w.Code)\n\tassert.Equal(t, \"Basic realm=\\\"Authorization Required\\\"\", w.Header().Get(\"WWW-Authenticate\"))\n}\nfunc TestBasicAuth401WithCustomRealm(t *testing.T) {\n\tcalled := false\n\taccounts := Accounts{\"foo\": \"bar\"}\n\trouter := New()\n\trouter.Use(BasicAuthForRealm(accounts, \"My Custom \\\"Realm\\\"\"))\n\trouter.GET(\"/login\", func(c *Context) {\n\t\tcalled = true\n\t\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n\t})\n\tw := httptest.NewRecorder()\n\treq, _ := http.NewRequest(\"GET\", \"/login\", nil)\n\treq.Header.Set(\"Authorization\", \"Basic \"+base64.StdEncoding.EncodeToString([]byte(\"admin:password\")))\n\trouter.ServeHTTP(w, req)\n\tassert.False(t, called)\n\tassert.Equal(t, http.StatusUnauthorized, w.Code)\n\tassert.Equal(t, \"Basic realm=\\\"My Custom \\\\\\\"Realm\\\\\\\"\\\"\", w.Header().Get(\"WWW-Authenticate\"))\n}\n","nodeType":"File","column":0,"line":0,"doc":null,"package":168,"name":{"children":[],"start":176,"end":179,"code":"gin","nodeType":"Identifier","column":0,"line":0,"namePos":176,"name":"gin","object":null},"declarations":[{"children":[],"start":181,"end":293,"code":"import (\n\t\"encoding/base64\"\n\t\"net/http\"\n\t\"net/http/httptest\"\n\t\"testing\"\n\t\"github.com/stretchr/testify/assert\"\n)","nodeType":"GenericDeclaration","column":0,"line":0,"doc":null,"tokenPosition":181,"token":75,"lparen":188,"specifications":[{"children":[],"start":191,"end":208,"code":"\"encoding/base64\"","nodeType":"ImportSpecification","column":0,"line":0,"doc":null,"name":null,"path":{"children":[],"start":191,"end":208,"code":"\"encoding/base64\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":191,"kind":9,"value":"\"encoding/base64\""},"comment":null,"endPosition":0},{"children":[],"start":210,"end":220,"code":"\"net/http\"","nodeType":"ImportSpecification","column":0,"line":0,"doc":null,"name":null,"path":{"children":[],"start":210,"end":220,"code":"\"net/http\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":210,"kind":9,"value":"\"net/http\""},"comment":null,"endPosition":0},{"children":[],"start":222,"end":241,"code":"\"net/http/httptest\"","nodeType":"ImportSpecification","column":0,"line":0,"doc":null,"name":null,"path":{"children":[],"start":222,"end":241,"code":"\"net/http/httptest\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":222,"kind":9,"value":"\"net/http/httptest\""},"comment":null,"endPosition":0},{"children":[],"start":243,"end":252,"code":"\"testing\"","nodeType":"ImportSpecification","column":0,"line":0,"doc":null,"name":null,"path":{"children":[],"start":243,"end":252,"code":"\"testing\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":243,"kind":9,"value":"\"testing\""},"comment":null,"endPosition":0},{"children":[],"start":255,"end":291,"code":"\"github.com/stretchr/testify/assert\"","nodeType":"ImportSpecification","column":0,"line":0,"doc":null,"name":null,"path":{"children":[],"start":255,"end":291,"code":"\"github.com/stretchr/testify/assert\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":255,"kind":9,"value":"\"github.com/stretchr/testify/assert\""},"comment":null,"endPosition":0}],"rparen":292},{"children":[],"start":295,"end":730,"code":"func TestBasicAuth(t *testing.T) {\n\tpairs := processAccounts(Accounts{\"admin\": \"password\", \"foo\": \"bar\", \"bar\": \"foo\"})\n\tassert.Len(t, pairs, 3)\n\tassert.Contains(t, pairs, authPair{user: \"bar\", value: \"Basic YmFyOmZvbw==\"})\n\tassert.Contains(t, pairs, authPair{user: \"foo\", value: \"Basic Zm9vOmJhcg==\"})\n\tassert.Contains(t, pairs, authPair{user: \"admin\", value: \"Basic YWRtaW46cGFzc3dvcmQ=\"})\n}","nodeType":"FunctionDeclaration","column":0,"line":0,"doc":null,"receiver":null,"name":{"children":[],"start":300,"end":313,"code":"TestBasicAuth","nodeType":"Identifier","column":0,"line":0,"namePos":300,"name":"TestBasicAuth","object":null},"type":{"children":[],"start":295,"end":327,"code":"func(t *testing.T)","nodeType":"FunctionType","column":0,"line":0,"Function":295,"TypeParams":null,"Params":{"children":[],"start":313,"end":327,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":313,"list":[{"children":[],"start":314,"end":326,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":314,"end":315,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":314,"name":"t","object":null}],"type":{"children":[],"start":316,"end":326,"code":"*testing.T","nodeType":"StarExpression","column":0,"line":0,"star":316,"expression":{"children":[],"start":317,"end":326,"code":"testing.T","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":317,"end":324,"code":"testing","nodeType":"Identifier","column":0,"line":0,"namePos":317,"name":"testing","object":null},"sel":{"children":[],"start":325,"end":326,"code":"T","nodeType":"Identifier","column":0,"line":0,"namePos":325,"name":"T","object":null}}},"tag":null,"comment":null}],"closing":326},"Results":null},"body":{"children":[],"start":328,"end":730,"code":"{\n\tpairs := processAccounts(Accounts{\"admin\": \"password\", \"foo\": \"bar\", \"bar\": \"foo\"})\n\tassert.Len(t, pairs, 3)\n\tassert.Contains(t, pairs, authPair{user: \"bar\", value: \"Basic YmFyOmZvbw==\"})\n\tassert.Contains(t, pairs, authPair{user: \"foo\", value: \"Basic Zm9vOmJhcg==\"})\n\tassert.Contains(t, pairs, authPair{user: \"admin\", value: \"Basic YWRtaW46cGFzc3dvcmQ=\"})\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":328,"list":[{"children":[],"start":331,"end":428,"code":"pairs := processAccounts(Accounts{\"admin\": \"password\", \"foo\": \"bar\", \"bar\": \"foo\"})","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":331,"end":336,"code":"pairs","nodeType":"Identifier","column":0,"line":0,"namePos":331,"name":"pairs","object":null}],"tokenPos":337,"token":47,"rhs":[{"children":[],"start":340,"end":428,"code":"processAccounts(Accounts{\"admin\": \"password\", \"foo\": \"bar\", \"bar\": \"foo\"})","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":340,"end":355,"code":"processAccounts","nodeType":"Identifier","column":0,"line":0,"namePos":340,"name":"processAccounts","object":null},"lparen":0,"args":[{"children":[],"start":356,"end":427,"code":"Accounts{\"admin\": \"password\", \"foo\": \"bar\", \"bar\": \"foo\"}","nodeType":"CompositeLiteral","column":0,"line":0,"type":{"children":[],"start":356,"end":364,"code":"Accounts","nodeType":"Identifier","column":0,"line":0,"namePos":356,"name":"Accounts","object":null},"lbrace":364,"elements":[{"children":[],"start":368,"end":387,"code":"\"admin\": \"password\"","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":368,"end":375,"code":"\"admin\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":368,"kind":9,"value":"\"admin\""},"colon":0,"value":{"children":[],"start":377,"end":387,"code":"\"password\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":377,"kind":9,"value":"\"password\""}},{"children":[],"start":391,"end":405,"code":"\"foo\": \"bar\"","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":391,"end":396,"code":"\"foo\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":391,"kind":9,"value":"\"foo\""},"colon":0,"value":{"children":[],"start":400,"end":405,"code":"\"bar\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":400,"kind":9,"value":"\"bar\""}},{"children":[],"start":409,"end":423,"code":"\"bar\": \"foo\"","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":409,"end":414,"code":"\"bar\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":409,"kind":9,"value":"\"bar\""},"colon":0,"value":{"children":[],"start":418,"end":423,"code":"\"foo\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":418,"kind":9,"value":"\"foo\""}}],"rbrace":426,"incomplete":false}],"ellipsis":0,"rparen":0}]},{"children":[],"start":431,"end":454,"code":"assert.Len(t, pairs, 3)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":431,"end":454,"code":"assert.Len(t, pairs, 3)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":431,"end":441,"code":"assert.Len","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":431,"end":437,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":431,"name":"assert","object":null},"sel":{"children":[],"start":438,"end":441,"code":"Len","nodeType":"Identifier","column":0,"line":0,"namePos":438,"name":"Len","object":null}},"lparen":0,"args":[{"children":[],"start":442,"end":443,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":442,"name":"t","object":null},{"children":[],"start":445,"end":450,"code":"pairs","nodeType":"Identifier","column":0,"line":0,"namePos":445,"name":"pairs","object":null},{"children":[],"start":452,"end":453,"code":"3","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":452,"kind":5,"value":"3"}],"ellipsis":0,"rparen":0}},{"children":[],"start":456,"end":542,"code":"assert.Contains(t, pairs, authPair{user: \"bar\", value: \"Basic YmFyOmZvbw==\"})","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":456,"end":542,"code":"assert.Contains(t, pairs, authPair{user: \"bar\", value: \"Basic YmFyOmZvbw==\"})","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":456,"end":471,"code":"assert.Contains","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":456,"end":462,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":456,"name":"assert","object":null},"sel":{"children":[],"start":463,"end":471,"code":"Contains","nodeType":"Identifier","column":0,"line":0,"namePos":463,"name":"Contains","object":null}},"lparen":0,"args":[{"children":[],"start":472,"end":473,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":472,"name":"t","object":null},{"children":[],"start":475,"end":480,"code":"pairs","nodeType":"Identifier","column":0,"line":0,"namePos":475,"name":"pairs","object":null},{"children":[],"start":482,"end":541,"code":"authPair{user: \"bar\", value: \"Basic YmFyOmZvbw==\"}","nodeType":"CompositeLiteral","column":0,"line":0,"type":{"children":[],"start":482,"end":490,"code":"authPair","nodeType":"Identifier","column":0,"line":0,"namePos":482,"name":"authPair","object":null},"lbrace":490,"elements":[{"children":[],"start":494,"end":506,"code":"user: \"bar\"","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":494,"end":498,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":494,"name":"user","object":null},"colon":0,"value":{"children":[],"start":501,"end":506,"code":"\"bar\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":501,"kind":9,"value":"\"bar\""}},{"children":[],"start":510,"end":537,"code":"value: \"Basic YmFyOmZvbw==\"","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":510,"end":515,"code":"value","nodeType":"Identifier","column":0,"line":0,"namePos":510,"name":"value","object":null},"colon":0,"value":{"children":[],"start":517,"end":537,"code":"\"Basic YmFyOmZvbw==\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":517,"kind":9,"value":"\"Basic YmFyOmZvbw==\""}}],"rbrace":540,"incomplete":false}],"ellipsis":0,"rparen":0}},{"children":[],"start":544,"end":630,"code":"assert.Contains(t, pairs, authPair{user: \"foo\", value: \"Basic Zm9vOmJhcg==\"})","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":544,"end":630,"code":"assert.Contains(t, pairs, authPair{user: \"foo\", value: \"Basic Zm9vOmJhcg==\"})","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":544,"end":559,"code":"assert.Contains","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":544,"end":550,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":544,"name":"assert","object":null},"sel":{"children":[],"start":551,"end":559,"code":"Contains","nodeType":"Identifier","column":0,"line":0,"namePos":551,"name":"Contains","object":null}},"lparen":0,"args":[{"children":[],"start":560,"end":561,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":560,"name":"t","object":null},{"children":[],"start":563,"end":568,"code":"pairs","nodeType":"Identifier","column":0,"line":0,"namePos":563,"name":"pairs","object":null},{"children":[],"start":570,"end":629,"code":"authPair{user: \"foo\", value: \"Basic Zm9vOmJhcg==\"}","nodeType":"CompositeLiteral","column":0,"line":0,"type":{"children":[],"start":570,"end":578,"code":"authPair","nodeType":"Identifier","column":0,"line":0,"namePos":570,"name":"authPair","object":null},"lbrace":578,"elements":[{"children":[],"start":582,"end":594,"code":"user: \"foo\"","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":582,"end":586,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":582,"name":"user","object":null},"colon":0,"value":{"children":[],"start":589,"end":594,"code":"\"foo\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":589,"kind":9,"value":"\"foo\""}},{"children":[],"start":598,"end":625,"code":"value: \"Basic Zm9vOmJhcg==\"","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":598,"end":603,"code":"value","nodeType":"Identifier","column":0,"line":0,"namePos":598,"name":"value","object":null},"colon":0,"value":{"children":[],"start":605,"end":625,"code":"\"Basic Zm9vOmJhcg==\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":605,"kind":9,"value":"\"Basic Zm9vOmJhcg==\""}}],"rbrace":628,"incomplete":false}],"ellipsis":0,"rparen":0}},{"children":[],"start":632,"end":728,"code":"assert.Contains(t, pairs, authPair{user: \"admin\", value: \"Basic YWRtaW46cGFzc3dvcmQ=\"})","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":632,"end":728,"code":"assert.Contains(t, pairs, authPair{user: \"admin\", value: \"Basic YWRtaW46cGFzc3dvcmQ=\"})","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":632,"end":647,"code":"assert.Contains","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":632,"end":638,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":632,"name":"assert","object":null},"sel":{"children":[],"start":639,"end":647,"code":"Contains","nodeType":"Identifier","column":0,"line":0,"namePos":639,"name":"Contains","object":null}},"lparen":0,"args":[{"children":[],"start":648,"end":649,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":648,"name":"t","object":null},{"children":[],"start":651,"end":656,"code":"pairs","nodeType":"Identifier","column":0,"line":0,"namePos":651,"name":"pairs","object":null},{"children":[],"start":658,"end":727,"code":"authPair{user: \"admin\", value: \"Basic YWRtaW46cGFzc3dvcmQ=\"}","nodeType":"CompositeLiteral","column":0,"line":0,"type":{"children":[],"start":658,"end":666,"code":"authPair","nodeType":"Identifier","column":0,"line":0,"namePos":658,"name":"authPair","object":null},"lbrace":666,"elements":[{"children":[],"start":670,"end":684,"code":"user: \"admin\"","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":670,"end":674,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":670,"name":"user","object":null},"colon":0,"value":{"children":[],"start":677,"end":684,"code":"\"admin\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":677,"kind":9,"value":"\"admin\""}},{"children":[],"start":688,"end":723,"code":"value: \"Basic YWRtaW46cGFzc3dvcmQ=\"","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":688,"end":693,"code":"value","nodeType":"Identifier","column":0,"line":0,"namePos":688,"name":"value","object":null},"colon":0,"value":{"children":[],"start":695,"end":723,"code":"\"Basic YWRtaW46cGFzc3dvcmQ=\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":695,"kind":9,"value":"\"Basic YWRtaW46cGFzc3dvcmQ=\""}}],"rbrace":726,"incomplete":false}],"ellipsis":0,"rparen":0}}],"rbrace":729}},{"children":[],"start":732,"end":927,"code":"func TestBasicAuthFails(t *testing.T) {\n\tassert.Panics(t, func() {\n\t\tprocessAccounts(nil)\n\t})\n\tassert.Panics(t, func() {\n\t\tprocessAccounts(Accounts{\"\": \"password\", \"foo\": \"bar\"})\n\t})\n}","nodeType":"FunctionDeclaration","column":0,"line":0,"doc":null,"receiver":null,"name":{"children":[],"start":737,"end":755,"code":"TestBasicAuthFails","nodeType":"Identifier","column":0,"line":0,"namePos":737,"name":"TestBasicAuthFails","object":null},"type":{"children":[],"start":732,"end":769,"code":"func(t *testing.T)","nodeType":"FunctionType","column":0,"line":0,"Function":732,"TypeParams":null,"Params":{"children":[],"start":755,"end":769,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":755,"list":[{"children":[],"start":756,"end":768,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":756,"end":757,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":756,"name":"t","object":null}],"type":{"children":[],"start":758,"end":768,"code":"*testing.T","nodeType":"StarExpression","column":0,"line":0,"star":758,"expression":{"children":[],"start":759,"end":768,"code":"testing.T","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":759,"end":766,"code":"testing","nodeType":"Identifier","column":0,"line":0,"namePos":759,"name":"testing","object":null},"sel":{"children":[],"start":767,"end":768,"code":"T","nodeType":"Identifier","column":0,"line":0,"namePos":767,"name":"T","object":null}}},"tag":null,"comment":null}],"closing":768},"Results":null},"body":{"children":[],"start":770,"end":927,"code":"{\n\tassert.Panics(t, func() {\n\t\tprocessAccounts(nil)\n\t})\n\tassert.Panics(t, func() {\n\t\tprocessAccounts(Accounts{\"\": \"password\", \"foo\": \"bar\"})\n\t})\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":770,"list":[{"children":[],"start":773,"end":822,"code":"assert.Panics(t, func() {\n\tprocessAccounts(nil)\n})","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":773,"end":822,"code":"assert.Panics(t, func() {\n\tprocessAccounts(nil)\n})","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":773,"end":786,"code":"assert.Panics","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":773,"end":779,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":773,"name":"assert","object":null},"sel":{"children":[],"start":780,"end":786,"code":"Panics","nodeType":"Identifier","column":0,"line":0,"namePos":780,"name":"Panics","object":null}},"lparen":0,"args":[{"children":[],"start":787,"end":788,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":787,"name":"t","object":null},{"children":[],"start":790,"end":821,"code":"func() {\n\tprocessAccounts(nil)\n}","nodeType":"FunctionLiteral","column":0,"line":0,"type":{"children":[],"start":790,"end":796,"code":"func()","nodeType":"FunctionType","column":0,"line":0,"Function":790,"TypeParams":null,"Params":{"children":[],"start":794,"end":796,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":794,"list":[],"closing":795},"Results":null},"body":{"children":[],"start":797,"end":821,"code":"{\n\tprocessAccounts(nil)\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":797,"list":[{"children":[],"start":799,"end":819,"code":"processAccounts(nil)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":799,"end":819,"code":"processAccounts(nil)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":799,"end":814,"code":"processAccounts","nodeType":"Identifier","column":0,"line":0,"namePos":799,"name":"processAccounts","object":null},"lparen":0,"args":[{"children":[],"start":815,"end":818,"code":"nil","nodeType":"Identifier","column":0,"line":0,"namePos":815,"name":"nil","object":null}],"ellipsis":0,"rparen":0}}],"rbrace":820}}],"ellipsis":0,"rparen":0}},{"children":[],"start":824,"end":925,"code":"assert.Panics(t, func() {\n\tprocessAccounts(Accounts{\"\": \"password\", \"foo\": \"bar\"})\n})","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":824,"end":925,"code":"assert.Panics(t, func() {\n\tprocessAccounts(Accounts{\"\": \"password\", \"foo\": \"bar\"})\n})","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":824,"end":837,"code":"assert.Panics","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":824,"end":830,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":824,"name":"assert","object":null},"sel":{"children":[],"start":831,"end":837,"code":"Panics","nodeType":"Identifier","column":0,"line":0,"namePos":831,"name":"Panics","object":null}},"lparen":0,"args":[{"children":[],"start":838,"end":839,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":838,"name":"t","object":null},{"children":[],"start":841,"end":924,"code":"func() {\n\tprocessAccounts(Accounts{\"\": \"password\", \"foo\": \"bar\"})\n}","nodeType":"FunctionLiteral","column":0,"line":0,"type":{"children":[],"start":841,"end":847,"code":"func()","nodeType":"FunctionType","column":0,"line":0,"Function":841,"TypeParams":null,"Params":{"children":[],"start":845,"end":847,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":845,"list":[],"closing":846},"Results":null},"body":{"children":[],"start":848,"end":924,"code":"{\n\tprocessAccounts(Accounts{\"\": \"password\", \"foo\": \"bar\"})\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":848,"list":[{"children":[],"start":852,"end":921,"code":"processAccounts(Accounts{\"\": \"password\", \"foo\": \"bar\"})","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":852,"end":921,"code":"processAccounts(Accounts{\"\": \"password\", \"foo\": \"bar\"})","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":852,"end":867,"code":"processAccounts","nodeType":"Identifier","column":0,"line":0,"namePos":852,"name":"processAccounts","object":null},"lparen":0,"args":[{"children":[],"start":868,"end":920,"code":"Accounts{\"\": \"password\", \"foo\": \"bar\"}","nodeType":"CompositeLiteral","column":0,"line":0,"type":{"children":[],"start":868,"end":876,"code":"Accounts","nodeType":"Identifier","column":0,"line":0,"namePos":868,"name":"Accounts","object":null},"lbrace":876,"elements":[{"children":[],"start":881,"end":898,"code":"\"\": \"password\"","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":881,"end":883,"code":"\"\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":881,"kind":9,"value":"\"\""},"colon":0,"value":{"children":[],"start":888,"end":898,"code":"\"password\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":888,"kind":9,"value":"\"password\""}},{"children":[],"start":903,"end":915,"code":"\"foo\": \"bar\"","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":903,"end":908,"code":"\"foo\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":903,"kind":9,"value":"\"foo\""},"colon":0,"value":{"children":[],"start":910,"end":915,"code":"\"bar\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":910,"kind":9,"value":"\"bar\""}}],"rbrace":919,"incomplete":false}],"ellipsis":0,"rparen":0}}],"rbrace":923}}],"ellipsis":0,"rparen":0}}],"rbrace":926}},{"children":[],"start":929,"end":1812,"code":"func TestBasicAuthSearchCredential(t *testing.T) {\n\tpairs := processAccounts(Accounts{\"admin\": \"password\", \"foo\": \"bar\", \"bar\": \"foo\"})\n\tuser, found := pairs.searchCredential(authorizationHeader(\"admin\", \"password\"))\n\tassert.Equal(t, \"admin\", user)\n\tassert.True(t, found)\n\tuser, found = pairs.searchCredential(authorizationHeader(\"foo\", \"bar\"))\n\tassert.Equal(t, \"foo\", user)\n\tassert.True(t, found)\n\tuser, found = pairs.searchCredential(authorizationHeader(\"bar\", \"foo\"))\n\tassert.Equal(t, \"bar\", user)\n\tassert.True(t, found)\n\tuser, found = pairs.searchCredential(authorizationHeader(\"admins\", \"password\"))\n\tassert.Empty(t, user)\n\tassert.False(t, found)\n\tuser, found = pairs.searchCredential(authorizationHeader(\"foo\", \"bar \"))\n\tassert.Empty(t, user)\n\tassert.False(t, found)\n\tuser, found = pairs.searchCredential(\"\")\n\tassert.Empty(t, user)\n\tassert.False(t, found)\n}","nodeType":"FunctionDeclaration","column":0,"line":0,"doc":null,"receiver":null,"name":{"children":[],"start":934,"end":963,"code":"TestBasicAuthSearchCredential","nodeType":"Identifier","column":0,"line":0,"namePos":934,"name":"TestBasicAuthSearchCredential","object":null},"type":{"children":[],"start":929,"end":977,"code":"func(t *testing.T)","nodeType":"FunctionType","column":0,"line":0,"Function":929,"TypeParams":null,"Params":{"children":[],"start":963,"end":977,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":963,"list":[{"children":[],"start":964,"end":976,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":964,"end":965,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":964,"name":"t","object":null}],"type":{"children":[],"start":966,"end":976,"code":"*testing.T","nodeType":"StarExpression","column":0,"line":0,"star":966,"expression":{"children":[],"start":967,"end":976,"code":"testing.T","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":967,"end":974,"code":"testing","nodeType":"Identifier","column":0,"line":0,"namePos":967,"name":"testing","object":null},"sel":{"children":[],"start":975,"end":976,"code":"T","nodeType":"Identifier","column":0,"line":0,"namePos":975,"name":"T","object":null}}},"tag":null,"comment":null}],"closing":976},"Results":null},"body":{"children":[],"start":978,"end":1812,"code":"{\n\tpairs := processAccounts(Accounts{\"admin\": \"password\", \"foo\": \"bar\", \"bar\": \"foo\"})\n\tuser, found := pairs.searchCredential(authorizationHeader(\"admin\", \"password\"))\n\tassert.Equal(t, \"admin\", user)\n\tassert.True(t, found)\n\tuser, found = pairs.searchCredential(authorizationHeader(\"foo\", \"bar\"))\n\tassert.Equal(t, \"foo\", user)\n\tassert.True(t, found)\n\tuser, found = pairs.searchCredential(authorizationHeader(\"bar\", \"foo\"))\n\tassert.Equal(t, \"bar\", user)\n\tassert.True(t, found)\n\tuser, found = pairs.searchCredential(authorizationHeader(\"admins\", \"password\"))\n\tassert.Empty(t, user)\n\tassert.False(t, found)\n\tuser, found = pairs.searchCredential(authorizationHeader(\"foo\", \"bar \"))\n\tassert.Empty(t, user)\n\tassert.False(t, found)\n\tuser, found = pairs.searchCredential(\"\")\n\tassert.Empty(t, user)\n\tassert.False(t, found)\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":978,"list":[{"children":[],"start":981,"end":1078,"code":"pairs := processAccounts(Accounts{\"admin\": \"password\", \"foo\": \"bar\", \"bar\": \"foo\"})","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":981,"end":986,"code":"pairs","nodeType":"Identifier","column":0,"line":0,"namePos":981,"name":"pairs","object":null}],"tokenPos":987,"token":47,"rhs":[{"children":[],"start":990,"end":1078,"code":"processAccounts(Accounts{\"admin\": \"password\", \"foo\": \"bar\", \"bar\": \"foo\"})","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":990,"end":1005,"code":"processAccounts","nodeType":"Identifier","column":0,"line":0,"namePos":990,"name":"processAccounts","object":null},"lparen":0,"args":[{"children":[],"start":1006,"end":1077,"code":"Accounts{\"admin\": \"password\", \"foo\": \"bar\", \"bar\": \"foo\"}","nodeType":"CompositeLiteral","column":0,"line":0,"type":{"children":[],"start":1006,"end":1014,"code":"Accounts","nodeType":"Identifier","column":0,"line":0,"namePos":1006,"name":"Accounts","object":null},"lbrace":1014,"elements":[{"children":[],"start":1018,"end":1037,"code":"\"admin\": \"password\"","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":1018,"end":1025,"code":"\"admin\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1018,"kind":9,"value":"\"admin\""},"colon":0,"value":{"children":[],"start":1027,"end":1037,"code":"\"password\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1027,"kind":9,"value":"\"password\""}},{"children":[],"start":1041,"end":1055,"code":"\"foo\": \"bar\"","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":1041,"end":1046,"code":"\"foo\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1041,"kind":9,"value":"\"foo\""},"colon":0,"value":{"children":[],"start":1050,"end":1055,"code":"\"bar\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1050,"kind":9,"value":"\"bar\""}},{"children":[],"start":1059,"end":1073,"code":"\"bar\": \"foo\"","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":1059,"end":1064,"code":"\"bar\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1059,"kind":9,"value":"\"bar\""},"colon":0,"value":{"children":[],"start":1068,"end":1073,"code":"\"foo\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1068,"kind":9,"value":"\"foo\""}}],"rbrace":1076,"incomplete":false}],"ellipsis":0,"rparen":0}]},{"children":[],"start":1081,"end":1160,"code":"user, found := pairs.searchCredential(authorizationHeader(\"admin\", \"password\"))","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":1081,"end":1085,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":1081,"name":"user","object":null},{"children":[],"start":1087,"end":1092,"code":"found","nodeType":"Identifier","column":0,"line":0,"namePos":1087,"name":"found","object":null}],"tokenPos":1093,"token":47,"rhs":[{"children":[],"start":1096,"end":1160,"code":"pairs.searchCredential(authorizationHeader(\"admin\", \"password\"))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1096,"end":1118,"code":"pairs.searchCredential","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1096,"end":1101,"code":"pairs","nodeType":"Identifier","column":0,"line":0,"namePos":1096,"name":"pairs","object":null},"sel":{"children":[],"start":1102,"end":1118,"code":"searchCredential","nodeType":"Identifier","column":0,"line":0,"namePos":1102,"name":"searchCredential","object":null}},"lparen":0,"args":[{"children":[],"start":1119,"end":1159,"code":"authorizationHeader(\"admin\", \"password\")","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1119,"end":1138,"code":"authorizationHeader","nodeType":"Identifier","column":0,"line":0,"namePos":1119,"name":"authorizationHeader","object":null},"lparen":0,"args":[{"children":[],"start":1139,"end":1146,"code":"\"admin\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1139,"kind":9,"value":"\"admin\""},{"children":[],"start":1148,"end":1158,"code":"\"password\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1148,"kind":9,"value":"\"password\""}],"ellipsis":0,"rparen":0}],"ellipsis":0,"rparen":0}]},{"children":[],"start":1162,"end":1192,"code":"assert.Equal(t, \"admin\", user)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":1162,"end":1192,"code":"assert.Equal(t, \"admin\", user)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1162,"end":1174,"code":"assert.Equal","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1162,"end":1168,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":1162,"name":"assert","object":null},"sel":{"children":[],"start":1169,"end":1174,"code":"Equal","nodeType":"Identifier","column":0,"line":0,"namePos":1169,"name":"Equal","object":null}},"lparen":0,"args":[{"children":[],"start":1175,"end":1176,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":1175,"name":"t","object":null},{"children":[],"start":1178,"end":1185,"code":"\"admin\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1178,"kind":9,"value":"\"admin\""},{"children":[],"start":1187,"end":1191,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":1187,"name":"user","object":null}],"ellipsis":0,"rparen":0}},{"children":[],"start":1194,"end":1215,"code":"assert.True(t, found)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":1194,"end":1215,"code":"assert.True(t, found)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1194,"end":1205,"code":"assert.True","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1194,"end":1200,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":1194,"name":"assert","object":null},"sel":{"children":[],"start":1201,"end":1205,"code":"True","nodeType":"Identifier","column":0,"line":0,"namePos":1201,"name":"True","object":null}},"lparen":0,"args":[{"children":[],"start":1206,"end":1207,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":1206,"name":"t","object":null},{"children":[],"start":1209,"end":1214,"code":"found","nodeType":"Identifier","column":0,"line":0,"namePos":1209,"name":"found","object":null}],"ellipsis":0,"rparen":0}},{"children":[],"start":1218,"end":1289,"code":"user, found = pairs.searchCredential(authorizationHeader(\"foo\", \"bar\"))","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":1218,"end":1222,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":1218,"name":"user","object":null},{"children":[],"start":1224,"end":1229,"code":"found","nodeType":"Identifier","column":0,"line":0,"namePos":1224,"name":"found","object":null}],"tokenPos":1230,"token":42,"rhs":[{"children":[],"start":1232,"end":1289,"code":"pairs.searchCredential(authorizationHeader(\"foo\", \"bar\"))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1232,"end":1254,"code":"pairs.searchCredential","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1232,"end":1237,"code":"pairs","nodeType":"Identifier","column":0,"line":0,"namePos":1232,"name":"pairs","object":null},"sel":{"children":[],"start":1238,"end":1254,"code":"searchCredential","nodeType":"Identifier","column":0,"line":0,"namePos":1238,"name":"searchCredential","object":null}},"lparen":0,"args":[{"children":[],"start":1255,"end":1288,"code":"authorizationHeader(\"foo\", \"bar\")","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1255,"end":1274,"code":"authorizationHeader","nodeType":"Identifier","column":0,"line":0,"namePos":1255,"name":"authorizationHeader","object":null},"lparen":0,"args":[{"children":[],"start":1275,"end":1280,"code":"\"foo\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1275,"kind":9,"value":"\"foo\""},{"children":[],"start":1282,"end":1287,"code":"\"bar\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1282,"kind":9,"value":"\"bar\""}],"ellipsis":0,"rparen":0}],"ellipsis":0,"rparen":0}]},{"children":[],"start":1291,"end":1319,"code":"assert.Equal(t, \"foo\", user)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":1291,"end":1319,"code":"assert.Equal(t, \"foo\", user)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1291,"end":1303,"code":"assert.Equal","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1291,"end":1297,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":1291,"name":"assert","object":null},"sel":{"children":[],"start":1298,"end":1303,"code":"Equal","nodeType":"Identifier","column":0,"line":0,"namePos":1298,"name":"Equal","object":null}},"lparen":0,"args":[{"children":[],"start":1304,"end":1305,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":1304,"name":"t","object":null},{"children":[],"start":1307,"end":1312,"code":"\"foo\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1307,"kind":9,"value":"\"foo\""},{"children":[],"start":1314,"end":1318,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":1314,"name":"user","object":null}],"ellipsis":0,"rparen":0}},{"children":[],"start":1321,"end":1342,"code":"assert.True(t, found)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":1321,"end":1342,"code":"assert.True(t, found)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1321,"end":1332,"code":"assert.True","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1321,"end":1327,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":1321,"name":"assert","object":null},"sel":{"children":[],"start":1328,"end":1332,"code":"True","nodeType":"Identifier","column":0,"line":0,"namePos":1328,"name":"True","object":null}},"lparen":0,"args":[{"children":[],"start":1333,"end":1334,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":1333,"name":"t","object":null},{"children":[],"start":1336,"end":1341,"code":"found","nodeType":"Identifier","column":0,"line":0,"namePos":1336,"name":"found","object":null}],"ellipsis":0,"rparen":0}},{"children":[],"start":1345,"end":1416,"code":"user, found = pairs.searchCredential(authorizationHeader(\"bar\", \"foo\"))","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":1345,"end":1349,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":1345,"name":"user","object":null},{"children":[],"start":1351,"end":1356,"code":"found","nodeType":"Identifier","column":0,"line":0,"namePos":1351,"name":"found","object":null}],"tokenPos":1357,"token":42,"rhs":[{"children":[],"start":1359,"end":1416,"code":"pairs.searchCredential(authorizationHeader(\"bar\", \"foo\"))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1359,"end":1381,"code":"pairs.searchCredential","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1359,"end":1364,"code":"pairs","nodeType":"Identifier","column":0,"line":0,"namePos":1359,"name":"pairs","object":null},"sel":{"children":[],"start":1365,"end":1381,"code":"searchCredential","nodeType":"Identifier","column":0,"line":0,"namePos":1365,"name":"searchCredential","object":null}},"lparen":0,"args":[{"children":[],"start":1382,"end":1415,"code":"authorizationHeader(\"bar\", \"foo\")","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1382,"end":1401,"code":"authorizationHeader","nodeType":"Identifier","column":0,"line":0,"namePos":1382,"name":"authorizationHeader","object":null},"lparen":0,"args":[{"children":[],"start":1402,"end":1407,"code":"\"bar\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1402,"kind":9,"value":"\"bar\""},{"children":[],"start":1409,"end":1414,"code":"\"foo\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1409,"kind":9,"value":"\"foo\""}],"ellipsis":0,"rparen":0}],"ellipsis":0,"rparen":0}]},{"children":[],"start":1418,"end":1446,"code":"assert.Equal(t, \"bar\", user)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":1418,"end":1446,"code":"assert.Equal(t, \"bar\", user)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1418,"end":1430,"code":"assert.Equal","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1418,"end":1424,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":1418,"name":"assert","object":null},"sel":{"children":[],"start":1425,"end":1430,"code":"Equal","nodeType":"Identifier","column":0,"line":0,"namePos":1425,"name":"Equal","object":null}},"lparen":0,"args":[{"children":[],"start":1431,"end":1432,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":1431,"name":"t","object":null},{"children":[],"start":1434,"end":1439,"code":"\"bar\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1434,"kind":9,"value":"\"bar\""},{"children":[],"start":1441,"end":1445,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":1441,"name":"user","object":null}],"ellipsis":0,"rparen":0}},{"children":[],"start":1448,"end":1469,"code":"assert.True(t, found)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":1448,"end":1469,"code":"assert.True(t, found)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1448,"end":1459,"code":"assert.True","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1448,"end":1454,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":1448,"name":"assert","object":null},"sel":{"children":[],"start":1455,"end":1459,"code":"True","nodeType":"Identifier","column":0,"line":0,"namePos":1455,"name":"True","object":null}},"lparen":0,"args":[{"children":[],"start":1460,"end":1461,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":1460,"name":"t","object":null},{"children":[],"start":1463,"end":1468,"code":"found","nodeType":"Identifier","column":0,"line":0,"namePos":1463,"name":"found","object":null}],"ellipsis":0,"rparen":0}},{"children":[],"start":1472,"end":1551,"code":"user, found = pairs.searchCredential(authorizationHeader(\"admins\", \"password\"))","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":1472,"end":1476,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":1472,"name":"user","object":null},{"children":[],"start":1478,"end":1483,"code":"found","nodeType":"Identifier","column":0,"line":0,"namePos":1478,"name":"found","object":null}],"tokenPos":1484,"token":42,"rhs":[{"children":[],"start":1486,"end":1551,"code":"pairs.searchCredential(authorizationHeader(\"admins\", \"password\"))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1486,"end":1508,"code":"pairs.searchCredential","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1486,"end":1491,"code":"pairs","nodeType":"Identifier","column":0,"line":0,"namePos":1486,"name":"pairs","object":null},"sel":{"children":[],"start":1492,"end":1508,"code":"searchCredential","nodeType":"Identifier","column":0,"line":0,"namePos":1492,"name":"searchCredential","object":null}},"lparen":0,"args":[{"children":[],"start":1509,"end":1550,"code":"authorizationHeader(\"admins\", \"password\")","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1509,"end":1528,"code":"authorizationHeader","nodeType":"Identifier","column":0,"line":0,"namePos":1509,"name":"authorizationHeader","object":null},"lparen":0,"args":[{"children":[],"start":1529,"end":1537,"code":"\"admins\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1529,"kind":9,"value":"\"admins\""},{"children":[],"start":1539,"end":1549,"code":"\"password\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1539,"kind":9,"value":"\"password\""}],"ellipsis":0,"rparen":0}],"ellipsis":0,"rparen":0}]},{"children":[],"start":1553,"end":1574,"code":"assert.Empty(t, user)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":1553,"end":1574,"code":"assert.Empty(t, user)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1553,"end":1565,"code":"assert.Empty","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1553,"end":1559,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":1553,"name":"assert","object":null},"sel":{"children":[],"start":1560,"end":1565,"code":"Empty","nodeType":"Identifier","column":0,"line":0,"namePos":1560,"name":"Empty","object":null}},"lparen":0,"args":[{"children":[],"start":1566,"end":1567,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":1566,"name":"t","object":null},{"children":[],"start":1569,"end":1573,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":1569,"name":"user","object":null}],"ellipsis":0,"rparen":0}},{"children":[],"start":1576,"end":1598,"code":"assert.False(t, found)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":1576,"end":1598,"code":"assert.False(t, found)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1576,"end":1588,"code":"assert.False","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1576,"end":1582,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":1576,"name":"assert","object":null},"sel":{"children":[],"start":1583,"end":1588,"code":"False","nodeType":"Identifier","column":0,"line":0,"namePos":1583,"name":"False","object":null}},"lparen":0,"args":[{"children":[],"start":1589,"end":1590,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":1589,"name":"t","object":null},{"children":[],"start":1592,"end":1597,"code":"found","nodeType":"Identifier","column":0,"line":0,"namePos":1592,"name":"found","object":null}],"ellipsis":0,"rparen":0}},{"children":[],"start":1601,"end":1673,"code":"user, found = pairs.searchCredential(authorizationHeader(\"foo\", \"bar \"))","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":1601,"end":1605,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":1601,"name":"user","object":null},{"children":[],"start":1607,"end":1612,"code":"found","nodeType":"Identifier","column":0,"line":0,"namePos":1607,"name":"found","object":null}],"tokenPos":1613,"token":42,"rhs":[{"children":[],"start":1615,"end":1673,"code":"pairs.searchCredential(authorizationHeader(\"foo\", \"bar \"))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1615,"end":1637,"code":"pairs.searchCredential","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1615,"end":1620,"code":"pairs","nodeType":"Identifier","column":0,"line":0,"namePos":1615,"name":"pairs","object":null},"sel":{"children":[],"start":1621,"end":1637,"code":"searchCredential","nodeType":"Identifier","column":0,"line":0,"namePos":1621,"name":"searchCredential","object":null}},"lparen":0,"args":[{"children":[],"start":1638,"end":1672,"code":"authorizationHeader(\"foo\", \"bar \")","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1638,"end":1657,"code":"authorizationHeader","nodeType":"Identifier","column":0,"line":0,"namePos":1638,"name":"authorizationHeader","object":null},"lparen":0,"args":[{"children":[],"start":1658,"end":1663,"code":"\"foo\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1658,"kind":9,"value":"\"foo\""},{"children":[],"start":1665,"end":1671,"code":"\"bar \"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1665,"kind":9,"value":"\"bar \""}],"ellipsis":0,"rparen":0}],"ellipsis":0,"rparen":0}]},{"children":[],"start":1675,"end":1696,"code":"assert.Empty(t, user)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":1675,"end":1696,"code":"assert.Empty(t, user)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1675,"end":1687,"code":"assert.Empty","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1675,"end":1681,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":1675,"name":"assert","object":null},"sel":{"children":[],"start":1682,"end":1687,"code":"Empty","nodeType":"Identifier","column":0,"line":0,"namePos":1682,"name":"Empty","object":null}},"lparen":0,"args":[{"children":[],"start":1688,"end":1689,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":1688,"name":"t","object":null},{"children":[],"start":1691,"end":1695,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":1691,"name":"user","object":null}],"ellipsis":0,"rparen":0}},{"children":[],"start":1698,"end":1720,"code":"assert.False(t, found)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":1698,"end":1720,"code":"assert.False(t, found)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1698,"end":1710,"code":"assert.False","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1698,"end":1704,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":1698,"name":"assert","object":null},"sel":{"children":[],"start":1705,"end":1710,"code":"False","nodeType":"Identifier","column":0,"line":0,"namePos":1705,"name":"False","object":null}},"lparen":0,"args":[{"children":[],"start":1711,"end":1712,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":1711,"name":"t","object":null},{"children":[],"start":1714,"end":1719,"code":"found","nodeType":"Identifier","column":0,"line":0,"namePos":1714,"name":"found","object":null}],"ellipsis":0,"rparen":0}},{"children":[],"start":1723,"end":1763,"code":"user, found = pairs.searchCredential(\"\")","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":1723,"end":1727,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":1723,"name":"user","object":null},{"children":[],"start":1729,"end":1734,"code":"found","nodeType":"Identifier","column":0,"line":0,"namePos":1729,"name":"found","object":null}],"tokenPos":1735,"token":42,"rhs":[{"children":[],"start":1737,"end":1763,"code":"pairs.searchCredential(\"\")","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1737,"end":1759,"code":"pairs.searchCredential","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1737,"end":1742,"code":"pairs","nodeType":"Identifier","column":0,"line":0,"namePos":1737,"name":"pairs","object":null},"sel":{"children":[],"start":1743,"end":1759,"code":"searchCredential","nodeType":"Identifier","column":0,"line":0,"namePos":1743,"name":"searchCredential","object":null}},"lparen":0,"args":[{"children":[],"start":1760,"end":1762,"code":"\"\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1760,"kind":9,"value":"\"\""}],"ellipsis":0,"rparen":0}]},{"children":[],"start":1765,"end":1786,"code":"assert.Empty(t, user)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":1765,"end":1786,"code":"assert.Empty(t, user)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1765,"end":1777,"code":"assert.Empty","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1765,"end":1771,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":1765,"name":"assert","object":null},"sel":{"children":[],"start":1772,"end":1777,"code":"Empty","nodeType":"Identifier","column":0,"line":0,"namePos":1772,"name":"Empty","object":null}},"lparen":0,"args":[{"children":[],"start":1778,"end":1779,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":1778,"name":"t","object":null},{"children":[],"start":1781,"end":1785,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":1781,"name":"user","object":null}],"ellipsis":0,"rparen":0}},{"children":[],"start":1788,"end":1810,"code":"assert.False(t, found)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":1788,"end":1810,"code":"assert.False(t, found)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1788,"end":1800,"code":"assert.False","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1788,"end":1794,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":1788,"name":"assert","object":null},"sel":{"children":[],"start":1795,"end":1800,"code":"False","nodeType":"Identifier","column":0,"line":0,"namePos":1795,"name":"False","object":null}},"lparen":0,"args":[{"children":[],"start":1801,"end":1802,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":1801,"name":"t","object":null},{"children":[],"start":1804,"end":1809,"code":"found","nodeType":"Identifier","column":0,"line":0,"namePos":1804,"name":"found","object":null}],"ellipsis":0,"rparen":0}}],"rbrace":1811}},{"children":[],"start":1814,"end":1958,"code":"func TestBasicAuthAuthorizationHeader(t *testing.T) {\n\tassert.Equal(t, \"Basic YWRtaW46cGFzc3dvcmQ=\", authorizationHeader(\"admin\", \"password\"))\n}","nodeType":"FunctionDeclaration","column":0,"line":0,"doc":null,"receiver":null,"name":{"children":[],"start":1819,"end":1851,"code":"TestBasicAuthAuthorizationHeader","nodeType":"Identifier","column":0,"line":0,"namePos":1819,"name":"TestBasicAuthAuthorizationHeader","object":null},"type":{"children":[],"start":1814,"end":1865,"code":"func(t *testing.T)","nodeType":"FunctionType","column":0,"line":0,"Function":1814,"TypeParams":null,"Params":{"children":[],"start":1851,"end":1865,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":1851,"list":[{"children":[],"start":1852,"end":1864,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":1852,"end":1853,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":1852,"name":"t","object":null}],"type":{"children":[],"start":1854,"end":1864,"code":"*testing.T","nodeType":"StarExpression","column":0,"line":0,"star":1854,"expression":{"children":[],"start":1855,"end":1864,"code":"testing.T","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1855,"end":1862,"code":"testing","nodeType":"Identifier","column":0,"line":0,"namePos":1855,"name":"testing","object":null},"sel":{"children":[],"start":1863,"end":1864,"code":"T","nodeType":"Identifier","column":0,"line":0,"namePos":1863,"name":"T","object":null}}},"tag":null,"comment":null}],"closing":1864},"Results":null},"body":{"children":[],"start":1866,"end":1958,"code":"{\n\tassert.Equal(t, \"Basic YWRtaW46cGFzc3dvcmQ=\", authorizationHeader(\"admin\", \"password\"))\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":1866,"list":[{"children":[],"start":1869,"end":1956,"code":"assert.Equal(t, \"Basic YWRtaW46cGFzc3dvcmQ=\", authorizationHeader(\"admin\", \"password\"))","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":1869,"end":1956,"code":"assert.Equal(t, \"Basic YWRtaW46cGFzc3dvcmQ=\", authorizationHeader(\"admin\", \"password\"))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1869,"end":1881,"code":"assert.Equal","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1869,"end":1875,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":1869,"name":"assert","object":null},"sel":{"children":[],"start":1876,"end":1881,"code":"Equal","nodeType":"Identifier","column":0,"line":0,"namePos":1876,"name":"Equal","object":null}},"lparen":0,"args":[{"children":[],"start":1882,"end":1883,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":1882,"name":"t","object":null},{"children":[],"start":1885,"end":1913,"code":"\"Basic YWRtaW46cGFzc3dvcmQ=\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1885,"kind":9,"value":"\"Basic YWRtaW46cGFzc3dvcmQ=\""},{"children":[],"start":1915,"end":1955,"code":"authorizationHeader(\"admin\", \"password\")","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1915,"end":1934,"code":"authorizationHeader","nodeType":"Identifier","column":0,"line":0,"namePos":1915,"name":"authorizationHeader","object":null},"lparen":0,"args":[{"children":[],"start":1935,"end":1942,"code":"\"admin\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1935,"kind":9,"value":"\"admin\""},{"children":[],"start":1944,"end":1954,"code":"\"password\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1944,"kind":9,"value":"\"password\""}],"ellipsis":0,"rparen":0}],"ellipsis":0,"rparen":0}}],"rbrace":1957}},{"children":[],"start":1960,"end":2464,"code":"func TestBasicAuthSucceed(t *testing.T) {\n\taccounts := Accounts{\"admin\": \"password\"}\n\trouter := New()\n\trouter.Use(BasicAuth(accounts))\n\trouter.GET(\"/login\", func(c *Context) {\n\t\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n\t})\n\tw := httptest.NewRecorder()\n\treq, _ := http.NewRequest(\"GET\", \"/login\", nil)\n\treq.Header.Set(\"Authorization\", authorizationHeader(\"admin\", \"password\"))\n\trouter.ServeHTTP(w, req)\n\tassert.Equal(t, http.StatusOK, w.Code)\n\tassert.Equal(t, \"admin\", w.Body.String())\n}","nodeType":"FunctionDeclaration","column":0,"line":0,"doc":null,"receiver":null,"name":{"children":[],"start":1965,"end":1985,"code":"TestBasicAuthSucceed","nodeType":"Identifier","column":0,"line":0,"namePos":1965,"name":"TestBasicAuthSucceed","object":null},"type":{"children":[],"start":1960,"end":1999,"code":"func(t *testing.T)","nodeType":"FunctionType","column":0,"line":0,"Function":1960,"TypeParams":null,"Params":{"children":[],"start":1985,"end":1999,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":1985,"list":[{"children":[],"start":1986,"end":1998,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":1986,"end":1987,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":1986,"name":"t","object":null}],"type":{"children":[],"start":1988,"end":1998,"code":"*testing.T","nodeType":"StarExpression","column":0,"line":0,"star":1988,"expression":{"children":[],"start":1989,"end":1998,"code":"testing.T","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1989,"end":1996,"code":"testing","nodeType":"Identifier","column":0,"line":0,"namePos":1989,"name":"testing","object":null},"sel":{"children":[],"start":1997,"end":1998,"code":"T","nodeType":"Identifier","column":0,"line":0,"namePos":1997,"name":"T","object":null}}},"tag":null,"comment":null}],"closing":1998},"Results":null},"body":{"children":[],"start":2000,"end":2464,"code":"{\n\taccounts := Accounts{\"admin\": \"password\"}\n\trouter := New()\n\trouter.Use(BasicAuth(accounts))\n\trouter.GET(\"/login\", func(c *Context) {\n\t\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n\t})\n\tw := httptest.NewRecorder()\n\treq, _ := http.NewRequest(\"GET\", \"/login\", nil)\n\treq.Header.Set(\"Authorization\", authorizationHeader(\"admin\", \"password\"))\n\trouter.ServeHTTP(w, req)\n\tassert.Equal(t, http.StatusOK, w.Code)\n\tassert.Equal(t, \"admin\", w.Body.String())\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":2000,"list":[{"children":[],"start":2003,"end":2044,"code":"accounts := Accounts{\"admin\": \"password\"}","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":2003,"end":2011,"code":"accounts","nodeType":"Identifier","column":0,"line":0,"namePos":2003,"name":"accounts","object":null}],"tokenPos":2012,"token":47,"rhs":[{"children":[],"start":2015,"end":2044,"code":"Accounts{\"admin\": \"password\"}","nodeType":"CompositeLiteral","column":0,"line":0,"type":{"children":[],"start":2015,"end":2023,"code":"Accounts","nodeType":"Identifier","column":0,"line":0,"namePos":2015,"name":"Accounts","object":null},"lbrace":2023,"elements":[{"children":[],"start":2024,"end":2043,"code":"\"admin\": \"password\"","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":2024,"end":2031,"code":"\"admin\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2024,"kind":9,"value":"\"admin\""},"colon":0,"value":{"children":[],"start":2033,"end":2043,"code":"\"password\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2033,"kind":9,"value":"\"password\""}}],"rbrace":2043,"incomplete":false}]},{"children":[],"start":2046,"end":2061,"code":"router := New()","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":2046,"end":2052,"code":"router","nodeType":"Identifier","column":0,"line":0,"namePos":2046,"name":"router","object":null}],"tokenPos":2053,"token":47,"rhs":[{"children":[],"start":2056,"end":2061,"code":"New()","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2056,"end":2059,"code":"New","nodeType":"Identifier","column":0,"line":0,"namePos":2056,"name":"New","object":null},"lparen":0,"args":[],"ellipsis":0,"rparen":0}]},{"children":[],"start":2063,"end":2094,"code":"router.Use(BasicAuth(accounts))","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":2063,"end":2094,"code":"router.Use(BasicAuth(accounts))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2063,"end":2073,"code":"router.Use","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2063,"end":2069,"code":"router","nodeType":"Identifier","column":0,"line":0,"namePos":2063,"name":"router","object":null},"sel":{"children":[],"start":2070,"end":2073,"code":"Use","nodeType":"Identifier","column":0,"line":0,"namePos":2070,"name":"Use","object":null}},"lparen":0,"args":[{"children":[],"start":2074,"end":2093,"code":"BasicAuth(accounts)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2074,"end":2083,"code":"BasicAuth","nodeType":"Identifier","column":0,"line":0,"namePos":2074,"name":"BasicAuth","object":null},"lparen":0,"args":[{"children":[],"start":2084,"end":2092,"code":"accounts","nodeType":"Identifier","column":0,"line":0,"namePos":2084,"name":"accounts","object":null}],"ellipsis":0,"rparen":0}],"ellipsis":0,"rparen":0}},{"children":[],"start":2096,"end":2198,"code":"router.GET(\"/login\", func(c *Context) {\n\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n})","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":2096,"end":2198,"code":"router.GET(\"/login\", func(c *Context) {\n\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n})","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2096,"end":2106,"code":"router.GET","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2096,"end":2102,"code":"router","nodeType":"Identifier","column":0,"line":0,"namePos":2096,"name":"router","object":null},"sel":{"children":[],"start":2103,"end":2106,"code":"GET","nodeType":"Identifier","column":0,"line":0,"namePos":2103,"name":"GET","object":null}},"lparen":0,"args":[{"children":[],"start":2107,"end":2115,"code":"\"/login\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2107,"kind":9,"value":"\"/login\""},{"children":[],"start":2117,"end":2197,"code":"func(c *Context) {\n\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n}","nodeType":"FunctionLiteral","column":0,"line":0,"type":{"children":[],"start":2117,"end":2133,"code":"func(c *Context)","nodeType":"FunctionType","column":0,"line":0,"Function":2117,"TypeParams":null,"Params":{"children":[],"start":2121,"end":2133,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":2121,"list":[{"children":[],"start":2122,"end":2132,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":2122,"end":2123,"code":"c","nodeType":"Identifier","column":0,"line":0,"namePos":2122,"name":"c","object":null}],"type":{"children":[],"start":2124,"end":2132,"code":"*Context","nodeType":"StarExpression","column":0,"line":0,"star":2124,"expression":{"children":[],"start":2125,"end":2132,"code":"Context","nodeType":"Identifier","column":0,"line":0,"namePos":2125,"name":"Context","object":null}},"tag":null,"comment":null}],"closing":2132},"Results":null},"body":{"children":[],"start":2134,"end":2197,"code":"{\n\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":2134,"list":[{"children":[],"start":2138,"end":2194,"code":"c.String(http.StatusOK, c.MustGet(AuthUserKey).(string))","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":2138,"end":2194,"code":"c.String(http.StatusOK, c.MustGet(AuthUserKey).(string))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2138,"end":2146,"code":"c.String","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2138,"end":2139,"code":"c","nodeType":"Identifier","column":0,"line":0,"namePos":2138,"name":"c","object":null},"sel":{"children":[],"start":2140,"end":2146,"code":"String","nodeType":"Identifier","column":0,"line":0,"namePos":2140,"name":"String","object":null}},"lparen":0,"args":[{"children":[],"start":2147,"end":2160,"code":"http.StatusOK","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2147,"end":2151,"code":"http","nodeType":"Identifier","column":0,"line":0,"namePos":2147,"name":"http","object":null},"sel":{"children":[],"start":2152,"end":2160,"code":"StatusOK","nodeType":"Identifier","column":0,"line":0,"namePos":2152,"name":"StatusOK","object":null}},{"children":[],"start":2162,"end":2193,"code":"c.MustGet(AuthUserKey).(string)","nodeType":"TypeAssertExpression","column":0,"line":0,"expression":{"children":[],"start":2162,"end":2184,"code":"c.MustGet(AuthUserKey)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2162,"end":2171,"code":"c.MustGet","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2162,"end":2163,"code":"c","nodeType":"Identifier","column":0,"line":0,"namePos":2162,"name":"c","object":null},"sel":{"children":[],"start":2164,"end":2171,"code":"MustGet","nodeType":"Identifier","column":0,"line":0,"namePos":2164,"name":"MustGet","object":null}},"lparen":0,"args":[{"children":[],"start":2172,"end":2183,"code":"AuthUserKey","nodeType":"Identifier","column":0,"line":0,"namePos":2172,"name":"AuthUserKey","object":null}],"ellipsis":0,"rparen":0},"lparen":2185,"type":{"children":[],"start":2186,"end":2192,"code":"string","nodeType":"Identifier","column":0,"line":0,"namePos":2186,"name":"string","object":null},"rparen":2192}],"ellipsis":0,"rparen":0}}],"rbrace":2196}}],"ellipsis":0,"rparen":0}},{"children":[],"start":2201,"end":2228,"code":"w := httptest.NewRecorder()","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":2201,"end":2202,"code":"w","nodeType":"Identifier","column":0,"line":0,"namePos":2201,"name":"w","object":null}],"tokenPos":2203,"token":47,"rhs":[{"children":[],"start":2206,"end":2228,"code":"httptest.NewRecorder()","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2206,"end":2226,"code":"httptest.NewRecorder","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2206,"end":2214,"code":"httptest","nodeType":"Identifier","column":0,"line":0,"namePos":2206,"name":"httptest","object":null},"sel":{"children":[],"start":2215,"end":2226,"code":"NewRecorder","nodeType":"Identifier","column":0,"line":0,"namePos":2215,"name":"NewRecorder","object":null}},"lparen":0,"args":[],"ellipsis":0,"rparen":0}]},{"children":[],"start":2230,"end":2277,"code":"req, _ := http.NewRequest(\"GET\", \"/login\", nil)","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":2230,"end":2233,"code":"req","nodeType":"Identifier","column":0,"line":0,"namePos":2230,"name":"req","object":null},{"children":[],"start":2235,"end":2236,"code":"_","nodeType":"Identifier","column":0,"line":0,"namePos":2235,"name":"_","object":null}],"tokenPos":2237,"token":47,"rhs":[{"children":[],"start":2240,"end":2277,"code":"http.NewRequest(\"GET\", \"/login\", nil)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2240,"end":2255,"code":"http.NewRequest","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2240,"end":2244,"code":"http","nodeType":"Identifier","column":0,"line":0,"namePos":2240,"name":"http","object":null},"sel":{"children":[],"start":2245,"end":2255,"code":"NewRequest","nodeType":"Identifier","column":0,"line":0,"namePos":2245,"name":"NewRequest","object":null}},"lparen":0,"args":[{"children":[],"start":2256,"end":2261,"code":"\"GET\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2256,"kind":9,"value":"\"GET\""},{"children":[],"start":2263,"end":2271,"code":"\"/login\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2263,"kind":9,"value":"\"/login\""},{"children":[],"start":2273,"end":2276,"code":"nil","nodeType":"Identifier","column":0,"line":0,"namePos":2273,"name":"nil","object":null}],"ellipsis":0,"rparen":0}]},{"children":[],"start":2279,"end":2352,"code":"req.Header.Set(\"Authorization\", authorizationHeader(\"admin\", \"password\"))","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":2279,"end":2352,"code":"req.Header.Set(\"Authorization\", authorizationHeader(\"admin\", \"password\"))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2279,"end":2293,"code":"req.Header.Set","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2279,"end":2289,"code":"req.Header","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2279,"end":2282,"code":"req","nodeType":"Identifier","column":0,"line":0,"namePos":2279,"name":"req","object":null},"sel":{"children":[],"start":2283,"end":2289,"code":"Header","nodeType":"Identifier","column":0,"line":0,"namePos":2283,"name":"Header","object":null}},"sel":{"children":[],"start":2290,"end":2293,"code":"Set","nodeType":"Identifier","column":0,"line":0,"namePos":2290,"name":"Set","object":null}},"lparen":0,"args":[{"children":[],"start":2294,"end":2309,"code":"\"Authorization\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2294,"kind":9,"value":"\"Authorization\""},{"children":[],"start":2311,"end":2351,"code":"authorizationHeader(\"admin\", \"password\")","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2311,"end":2330,"code":"authorizationHeader","nodeType":"Identifier","column":0,"line":0,"namePos":2311,"name":"authorizationHeader","object":null},"lparen":0,"args":[{"children":[],"start":2331,"end":2338,"code":"\"admin\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2331,"kind":9,"value":"\"admin\""},{"children":[],"start":2340,"end":2350,"code":"\"password\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2340,"kind":9,"value":"\"password\""}],"ellipsis":0,"rparen":0}],"ellipsis":0,"rparen":0}},{"children":[],"start":2354,"end":2378,"code":"router.ServeHTTP(w, req)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":2354,"end":2378,"code":"router.ServeHTTP(w, req)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2354,"end":2370,"code":"router.ServeHTTP","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2354,"end":2360,"code":"router","nodeType":"Identifier","column":0,"line":0,"namePos":2354,"name":"router","object":null},"sel":{"children":[],"start":2361,"end":2370,"code":"ServeHTTP","nodeType":"Identifier","column":0,"line":0,"namePos":2361,"name":"ServeHTTP","object":null}},"lparen":0,"args":[{"children":[],"start":2371,"end":2372,"code":"w","nodeType":"Identifier","column":0,"line":0,"namePos":2371,"name":"w","object":null},{"children":[],"start":2374,"end":2377,"code":"req","nodeType":"Identifier","column":0,"line":0,"namePos":2374,"name":"req","object":null}],"ellipsis":0,"rparen":0}},{"children":[],"start":2381,"end":2419,"code":"assert.Equal(t, http.StatusOK, w.Code)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":2381,"end":2419,"code":"assert.Equal(t, http.StatusOK, w.Code)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2381,"end":2393,"code":"assert.Equal","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2381,"end":2387,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":2381,"name":"assert","object":null},"sel":{"children":[],"start":2388,"end":2393,"code":"Equal","nodeType":"Identifier","column":0,"line":0,"namePos":2388,"name":"Equal","object":null}},"lparen":0,"args":[{"children":[],"start":2394,"end":2395,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":2394,"name":"t","object":null},{"children":[],"start":2397,"end":2410,"code":"http.StatusOK","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2397,"end":2401,"code":"http","nodeType":"Identifier","column":0,"line":0,"namePos":2397,"name":"http","object":null},"sel":{"children":[],"start":2402,"end":2410,"code":"StatusOK","nodeType":"Identifier","column":0,"line":0,"namePos":2402,"name":"StatusOK","object":null}},{"children":[],"start":2412,"end":2418,"code":"w.Code","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2412,"end":2413,"code":"w","nodeType":"Identifier","column":0,"line":0,"namePos":2412,"name":"w","object":null},"sel":{"children":[],"start":2414,"end":2418,"code":"Code","nodeType":"Identifier","column":0,"line":0,"namePos":2414,"name":"Code","object":null}}],"ellipsis":0,"rparen":0}},{"children":[],"start":2421,"end":2462,"code":"assert.Equal(t, \"admin\", w.Body.String())","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":2421,"end":2462,"code":"assert.Equal(t, \"admin\", w.Body.String())","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2421,"end":2433,"code":"assert.Equal","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2421,"end":2427,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":2421,"name":"assert","object":null},"sel":{"children":[],"start":2428,"end":2433,"code":"Equal","nodeType":"Identifier","column":0,"line":0,"namePos":2428,"name":"Equal","object":null}},"lparen":0,"args":[{"children":[],"start":2434,"end":2435,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":2434,"name":"t","object":null},{"children":[],"start":2437,"end":2444,"code":"\"admin\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2437,"kind":9,"value":"\"admin\""},{"children":[],"start":2446,"end":2461,"code":"w.Body.String()","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2446,"end":2459,"code":"w.Body.String","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2446,"end":2452,"code":"w.Body","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2446,"end":2447,"code":"w","nodeType":"Identifier","column":0,"line":0,"namePos":2446,"name":"w","object":null},"sel":{"children":[],"start":2448,"end":2452,"code":"Body","nodeType":"Identifier","column":0,"line":0,"namePos":2448,"name":"Body","object":null}},"sel":{"children":[],"start":2453,"end":2459,"code":"String","nodeType":"Identifier","column":0,"line":0,"namePos":2453,"name":"String","object":null}},"lparen":0,"args":[],"ellipsis":0,"rparen":0}],"ellipsis":0,"rparen":0}}],"rbrace":2463}},{"children":[],"start":2466,"end":3107,"code":"func TestBasicAuth401(t *testing.T) {\n\tcalled := false\n\taccounts := Accounts{\"foo\": \"bar\"}\n\trouter := New()\n\trouter.Use(BasicAuth(accounts))\n\trouter.GET(\"/login\", func(c *Context) {\n\t\tcalled = true\n\t\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n\t})\n\tw := httptest.NewRecorder()\n\treq, _ := http.NewRequest(\"GET\", \"/login\", nil)\n\treq.Header.Set(\"Authorization\", \"Basic \"+base64.StdEncoding.EncodeToString([]byte(\"admin:password\")))\n\trouter.ServeHTTP(w, req)\n\tassert.False(t, called)\n\tassert.Equal(t, http.StatusUnauthorized, w.Code)\n\tassert.Equal(t, \"Basic realm=\\\"Authorization Required\\\"\", w.Header().Get(\"WWW-Authenticate\"))\n}","nodeType":"FunctionDeclaration","column":0,"line":0,"doc":null,"receiver":null,"name":{"children":[],"start":2471,"end":2487,"code":"TestBasicAuth401","nodeType":"Identifier","column":0,"line":0,"namePos":2471,"name":"TestBasicAuth401","object":null},"type":{"children":[],"start":2466,"end":2501,"code":"func(t *testing.T)","nodeType":"FunctionType","column":0,"line":0,"Function":2466,"TypeParams":null,"Params":{"children":[],"start":2487,"end":2501,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":2487,"list":[{"children":[],"start":2488,"end":2500,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":2488,"end":2489,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":2488,"name":"t","object":null}],"type":{"children":[],"start":2490,"end":2500,"code":"*testing.T","nodeType":"StarExpression","column":0,"line":0,"star":2490,"expression":{"children":[],"start":2491,"end":2500,"code":"testing.T","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2491,"end":2498,"code":"testing","nodeType":"Identifier","column":0,"line":0,"namePos":2491,"name":"testing","object":null},"sel":{"children":[],"start":2499,"end":2500,"code":"T","nodeType":"Identifier","column":0,"line":0,"namePos":2499,"name":"T","object":null}}},"tag":null,"comment":null}],"closing":2500},"Results":null},"body":{"children":[],"start":2502,"end":3107,"code":"{\n\tcalled := false\n\taccounts := Accounts{\"foo\": \"bar\"}\n\trouter := New()\n\trouter.Use(BasicAuth(accounts))\n\trouter.GET(\"/login\", func(c *Context) {\n\t\tcalled = true\n\t\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n\t})\n\tw := httptest.NewRecorder()\n\treq, _ := http.NewRequest(\"GET\", \"/login\", nil)\n\treq.Header.Set(\"Authorization\", \"Basic \"+base64.StdEncoding.EncodeToString([]byte(\"admin:password\")))\n\trouter.ServeHTTP(w, req)\n\tassert.False(t, called)\n\tassert.Equal(t, http.StatusUnauthorized, w.Code)\n\tassert.Equal(t, \"Basic realm=\\\"Authorization Required\\\"\", w.Header().Get(\"WWW-Authenticate\"))\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":2502,"list":[{"children":[],"start":2505,"end":2520,"code":"called := false","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":2505,"end":2511,"code":"called","nodeType":"Identifier","column":0,"line":0,"namePos":2505,"name":"called","object":null}],"tokenPos":2512,"token":47,"rhs":[{"children":[],"start":2515,"end":2520,"code":"false","nodeType":"Identifier","column":0,"line":0,"namePos":2515,"name":"false","object":null}]},{"children":[],"start":2522,"end":2556,"code":"accounts := Accounts{\"foo\": \"bar\"}","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":2522,"end":2530,"code":"accounts","nodeType":"Identifier","column":0,"line":0,"namePos":2522,"name":"accounts","object":null}],"tokenPos":2531,"token":47,"rhs":[{"children":[],"start":2534,"end":2556,"code":"Accounts{\"foo\": \"bar\"}","nodeType":"CompositeLiteral","column":0,"line":0,"type":{"children":[],"start":2534,"end":2542,"code":"Accounts","nodeType":"Identifier","column":0,"line":0,"namePos":2534,"name":"Accounts","object":null},"lbrace":2542,"elements":[{"children":[],"start":2543,"end":2555,"code":"\"foo\": \"bar\"","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":2543,"end":2548,"code":"\"foo\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2543,"kind":9,"value":"\"foo\""},"colon":0,"value":{"children":[],"start":2550,"end":2555,"code":"\"bar\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2550,"kind":9,"value":"\"bar\""}}],"rbrace":2555,"incomplete":false}]},{"children":[],"start":2558,"end":2573,"code":"router := New()","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":2558,"end":2564,"code":"router","nodeType":"Identifier","column":0,"line":0,"namePos":2558,"name":"router","object":null}],"tokenPos":2565,"token":47,"rhs":[{"children":[],"start":2568,"end":2573,"code":"New()","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2568,"end":2571,"code":"New","nodeType":"Identifier","column":0,"line":0,"namePos":2568,"name":"New","object":null},"lparen":0,"args":[],"ellipsis":0,"rparen":0}]},{"children":[],"start":2575,"end":2606,"code":"router.Use(BasicAuth(accounts))","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":2575,"end":2606,"code":"router.Use(BasicAuth(accounts))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2575,"end":2585,"code":"router.Use","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2575,"end":2581,"code":"router","nodeType":"Identifier","column":0,"line":0,"namePos":2575,"name":"router","object":null},"sel":{"children":[],"start":2582,"end":2585,"code":"Use","nodeType":"Identifier","column":0,"line":0,"namePos":2582,"name":"Use","object":null}},"lparen":0,"args":[{"children":[],"start":2586,"end":2605,"code":"BasicAuth(accounts)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2586,"end":2595,"code":"BasicAuth","nodeType":"Identifier","column":0,"line":0,"namePos":2586,"name":"BasicAuth","object":null},"lparen":0,"args":[{"children":[],"start":2596,"end":2604,"code":"accounts","nodeType":"Identifier","column":0,"line":0,"namePos":2596,"name":"accounts","object":null}],"ellipsis":0,"rparen":0}],"ellipsis":0,"rparen":0}},{"children":[],"start":2608,"end":2726,"code":"router.GET(\"/login\", func(c *Context) {\n\tcalled = true\n\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n})","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":2608,"end":2726,"code":"router.GET(\"/login\", func(c *Context) {\n\tcalled = true\n\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n})","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2608,"end":2618,"code":"router.GET","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2608,"end":2614,"code":"router","nodeType":"Identifier","column":0,"line":0,"namePos":2608,"name":"router","object":null},"sel":{"children":[],"start":2615,"end":2618,"code":"GET","nodeType":"Identifier","column":0,"line":0,"namePos":2615,"name":"GET","object":null}},"lparen":0,"args":[{"children":[],"start":2619,"end":2627,"code":"\"/login\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2619,"kind":9,"value":"\"/login\""},{"children":[],"start":2629,"end":2725,"code":"func(c *Context) {\n\tcalled = true\n\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n}","nodeType":"FunctionLiteral","column":0,"line":0,"type":{"children":[],"start":2629,"end":2645,"code":"func(c *Context)","nodeType":"FunctionType","column":0,"line":0,"Function":2629,"TypeParams":null,"Params":{"children":[],"start":2633,"end":2645,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":2633,"list":[{"children":[],"start":2634,"end":2644,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":2634,"end":2635,"code":"c","nodeType":"Identifier","column":0,"line":0,"namePos":2634,"name":"c","object":null}],"type":{"children":[],"start":2636,"end":2644,"code":"*Context","nodeType":"StarExpression","column":0,"line":0,"star":2636,"expression":{"children":[],"start":2637,"end":2644,"code":"Context","nodeType":"Identifier","column":0,"line":0,"namePos":2637,"name":"Context","object":null}},"tag":null,"comment":null}],"closing":2644},"Results":null},"body":{"children":[],"start":2646,"end":2725,"code":"{\n\tcalled = true\n\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":2646,"list":[{"children":[],"start":2650,"end":2663,"code":"called = true","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":2650,"end":2656,"code":"called","nodeType":"Identifier","column":0,"line":0,"namePos":2650,"name":"called","object":null}],"tokenPos":2657,"token":42,"rhs":[{"children":[],"start":2659,"end":2663,"code":"true","nodeType":"Identifier","column":0,"line":0,"namePos":2659,"name":"true","object":null}]},{"children":[],"start":2666,"end":2722,"code":"c.String(http.StatusOK, c.MustGet(AuthUserKey).(string))","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":2666,"end":2722,"code":"c.String(http.StatusOK, c.MustGet(AuthUserKey).(string))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2666,"end":2674,"code":"c.String","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2666,"end":2667,"code":"c","nodeType":"Identifier","column":0,"line":0,"namePos":2666,"name":"c","object":null},"sel":{"children":[],"start":2668,"end":2674,"code":"String","nodeType":"Identifier","column":0,"line":0,"namePos":2668,"name":"String","object":null}},"lparen":0,"args":[{"children":[],"start":2675,"end":2688,"code":"http.StatusOK","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2675,"end":2679,"code":"http","nodeType":"Identifier","column":0,"line":0,"namePos":2675,"name":"http","object":null},"sel":{"children":[],"start":2680,"end":2688,"code":"StatusOK","nodeType":"Identifier","column":0,"line":0,"namePos":2680,"name":"StatusOK","object":null}},{"children":[],"start":2690,"end":2721,"code":"c.MustGet(AuthUserKey).(string)","nodeType":"TypeAssertExpression","column":0,"line":0,"expression":{"children":[],"start":2690,"end":2712,"code":"c.MustGet(AuthUserKey)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2690,"end":2699,"code":"c.MustGet","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2690,"end":2691,"code":"c","nodeType":"Identifier","column":0,"line":0,"namePos":2690,"name":"c","object":null},"sel":{"children":[],"start":2692,"end":2699,"code":"MustGet","nodeType":"Identifier","column":0,"line":0,"namePos":2692,"name":"MustGet","object":null}},"lparen":0,"args":[{"children":[],"start":2700,"end":2711,"code":"AuthUserKey","nodeType":"Identifier","column":0,"line":0,"namePos":2700,"name":"AuthUserKey","object":null}],"ellipsis":0,"rparen":0},"lparen":2713,"type":{"children":[],"start":2714,"end":2720,"code":"string","nodeType":"Identifier","column":0,"line":0,"namePos":2714,"name":"string","object":null},"rparen":2720}],"ellipsis":0,"rparen":0}}],"rbrace":2724}}],"ellipsis":0,"rparen":0}},{"children":[],"start":2729,"end":2756,"code":"w := httptest.NewRecorder()","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":2729,"end":2730,"code":"w","nodeType":"Identifier","column":0,"line":0,"namePos":2729,"name":"w","object":null}],"tokenPos":2731,"token":47,"rhs":[{"children":[],"start":2734,"end":2756,"code":"httptest.NewRecorder()","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2734,"end":2754,"code":"httptest.NewRecorder","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2734,"end":2742,"code":"httptest","nodeType":"Identifier","column":0,"line":0,"namePos":2734,"name":"httptest","object":null},"sel":{"children":[],"start":2743,"end":2754,"code":"NewRecorder","nodeType":"Identifier","column":0,"line":0,"namePos":2743,"name":"NewRecorder","object":null}},"lparen":0,"args":[],"ellipsis":0,"rparen":0}]},{"children":[],"start":2758,"end":2805,"code":"req, _ := http.NewRequest(\"GET\", \"/login\", nil)","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":2758,"end":2761,"code":"req","nodeType":"Identifier","column":0,"line":0,"namePos":2758,"name":"req","object":null},{"children":[],"start":2763,"end":2764,"code":"_","nodeType":"Identifier","column":0,"line":0,"namePos":2763,"name":"_","object":null}],"tokenPos":2765,"token":47,"rhs":[{"children":[],"start":2768,"end":2805,"code":"http.NewRequest(\"GET\", \"/login\", nil)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2768,"end":2783,"code":"http.NewRequest","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2768,"end":2772,"code":"http","nodeType":"Identifier","column":0,"line":0,"namePos":2768,"name":"http","object":null},"sel":{"children":[],"start":2773,"end":2783,"code":"NewRequest","nodeType":"Identifier","column":0,"line":0,"namePos":2773,"name":"NewRequest","object":null}},"lparen":0,"args":[{"children":[],"start":2784,"end":2789,"code":"\"GET\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2784,"kind":9,"value":"\"GET\""},{"children":[],"start":2791,"end":2799,"code":"\"/login\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2791,"kind":9,"value":"\"/login\""},{"children":[],"start":2801,"end":2804,"code":"nil","nodeType":"Identifier","column":0,"line":0,"namePos":2801,"name":"nil","object":null}],"ellipsis":0,"rparen":0}]},{"children":[],"start":2807,"end":2908,"code":"req.Header.Set(\"Authorization\", \"Basic \"+base64.StdEncoding.EncodeToString([]byte(\"admin:password\")))","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":2807,"end":2908,"code":"req.Header.Set(\"Authorization\", \"Basic \"+base64.StdEncoding.EncodeToString([]byte(\"admin:password\")))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2807,"end":2821,"code":"req.Header.Set","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2807,"end":2817,"code":"req.Header","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2807,"end":2810,"code":"req","nodeType":"Identifier","column":0,"line":0,"namePos":2807,"name":"req","object":null},"sel":{"children":[],"start":2811,"end":2817,"code":"Header","nodeType":"Identifier","column":0,"line":0,"namePos":2811,"name":"Header","object":null}},"sel":{"children":[],"start":2818,"end":2821,"code":"Set","nodeType":"Identifier","column":0,"line":0,"namePos":2818,"name":"Set","object":null}},"lparen":0,"args":[{"children":[],"start":2822,"end":2837,"code":"\"Authorization\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2822,"kind":9,"value":"\"Authorization\""},{"children":[],"start":2839,"end":2907,"code":"\"Basic \" + base64.StdEncoding.EncodeToString([]byte(\"admin:password\"))","nodeType":"BinaryExpression","column":0,"line":0,"leftExpression":{"children":[],"start":2839,"end":2847,"code":"\"Basic \"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2839,"kind":9,"value":"\"Basic \""},"opPos":2847,"op":12,"rightExpression":{"children":[],"start":2848,"end":2907,"code":"base64.StdEncoding.EncodeToString([]byte(\"admin:password\"))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2848,"end":2881,"code":"base64.StdEncoding.EncodeToString","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2848,"end":2866,"code":"base64.StdEncoding","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2848,"end":2854,"code":"base64","nodeType":"Identifier","column":0,"line":0,"namePos":2848,"name":"base64","object":null},"sel":{"children":[],"start":2855,"end":2866,"code":"StdEncoding","nodeType":"Identifier","column":0,"line":0,"namePos":2855,"name":"StdEncoding","object":null}},"sel":{"children":[],"start":2867,"end":2881,"code":"EncodeToString","nodeType":"Identifier","column":0,"line":0,"namePos":2867,"name":"EncodeToString","object":null}},"lparen":0,"args":[{"children":[],"start":2882,"end":2906,"code":"[]byte(\"admin:password\")","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2882,"end":2888,"code":"[]byte","nodeType":"ArrayType","column":0,"line":0,"leftBracket":2882,"length":null,"element":{"children":[],"start":2884,"end":2888,"code":"byte","nodeType":"Identifier","column":0,"line":0,"namePos":2884,"name":"byte","object":null}},"lparen":0,"args":[{"children":[],"start":2889,"end":2905,"code":"\"admin:password\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2889,"kind":9,"value":"\"admin:password\""}],"ellipsis":0,"rparen":0}],"ellipsis":0,"rparen":0}}],"ellipsis":0,"rparen":0}},{"children":[],"start":2910,"end":2934,"code":"router.ServeHTTP(w, req)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":2910,"end":2934,"code":"router.ServeHTTP(w, req)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2910,"end":2926,"code":"router.ServeHTTP","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2910,"end":2916,"code":"router","nodeType":"Identifier","column":0,"line":0,"namePos":2910,"name":"router","object":null},"sel":{"children":[],"start":2917,"end":2926,"code":"ServeHTTP","nodeType":"Identifier","column":0,"line":0,"namePos":2917,"name":"ServeHTTP","object":null}},"lparen":0,"args":[{"children":[],"start":2927,"end":2928,"code":"w","nodeType":"Identifier","column":0,"line":0,"namePos":2927,"name":"w","object":null},{"children":[],"start":2930,"end":2933,"code":"req","nodeType":"Identifier","column":0,"line":0,"namePos":2930,"name":"req","object":null}],"ellipsis":0,"rparen":0}},{"children":[],"start":2937,"end":2960,"code":"assert.False(t, called)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":2937,"end":2960,"code":"assert.False(t, called)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2937,"end":2949,"code":"assert.False","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2937,"end":2943,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":2937,"name":"assert","object":null},"sel":{"children":[],"start":2944,"end":2949,"code":"False","nodeType":"Identifier","column":0,"line":0,"namePos":2944,"name":"False","object":null}},"lparen":0,"args":[{"children":[],"start":2950,"end":2951,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":2950,"name":"t","object":null},{"children":[],"start":2953,"end":2959,"code":"called","nodeType":"Identifier","column":0,"line":0,"namePos":2953,"name":"called","object":null}],"ellipsis":0,"rparen":0}},{"children":[],"start":2962,"end":3010,"code":"assert.Equal(t, http.StatusUnauthorized, w.Code)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":2962,"end":3010,"code":"assert.Equal(t, http.StatusUnauthorized, w.Code)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2962,"end":2974,"code":"assert.Equal","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2962,"end":2968,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":2962,"name":"assert","object":null},"sel":{"children":[],"start":2969,"end":2974,"code":"Equal","nodeType":"Identifier","column":0,"line":0,"namePos":2969,"name":"Equal","object":null}},"lparen":0,"args":[{"children":[],"start":2975,"end":2976,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":2975,"name":"t","object":null},{"children":[],"start":2978,"end":3001,"code":"http.StatusUnauthorized","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2978,"end":2982,"code":"http","nodeType":"Identifier","column":0,"line":0,"namePos":2978,"name":"http","object":null},"sel":{"children":[],"start":2983,"end":3001,"code":"StatusUnauthorized","nodeType":"Identifier","column":0,"line":0,"namePos":2983,"name":"StatusUnauthorized","object":null}},{"children":[],"start":3003,"end":3009,"code":"w.Code","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3003,"end":3004,"code":"w","nodeType":"Identifier","column":0,"line":0,"namePos":3003,"name":"w","object":null},"sel":{"children":[],"start":3005,"end":3009,"code":"Code","nodeType":"Identifier","column":0,"line":0,"namePos":3005,"name":"Code","object":null}}],"ellipsis":0,"rparen":0}},{"children":[],"start":3012,"end":3105,"code":"assert.Equal(t, \"Basic realm=\\\"Authorization Required\\\"\", w.Header().Get(\"WWW-Authenticate\"))","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":3012,"end":3105,"code":"assert.Equal(t, \"Basic realm=\\\"Authorization Required\\\"\", w.Header().Get(\"WWW-Authenticate\"))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3012,"end":3024,"code":"assert.Equal","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3012,"end":3018,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":3012,"name":"assert","object":null},"sel":{"children":[],"start":3019,"end":3024,"code":"Equal","nodeType":"Identifier","column":0,"line":0,"namePos":3019,"name":"Equal","object":null}},"lparen":0,"args":[{"children":[],"start":3025,"end":3026,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":3025,"name":"t","object":null},{"children":[],"start":3028,"end":3068,"code":"\"Basic realm=\\\"Authorization Required\\\"\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":3028,"kind":9,"value":"\"Basic realm=\\\"Authorization Required\\\"\""},{"children":[],"start":3070,"end":3104,"code":"w.Header().Get(\"WWW-Authenticate\")","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3070,"end":3084,"code":"w.Header().Get","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3070,"end":3080,"code":"w.Header()","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3070,"end":3078,"code":"w.Header","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3070,"end":3071,"code":"w","nodeType":"Identifier","column":0,"line":0,"namePos":3070,"name":"w","object":null},"sel":{"children":[],"start":3072,"end":3078,"code":"Header","nodeType":"Identifier","column":0,"line":0,"namePos":3072,"name":"Header","object":null}},"lparen":0,"args":[],"ellipsis":0,"rparen":0},"sel":{"children":[],"start":3081,"end":3084,"code":"Get","nodeType":"Identifier","column":0,"line":0,"namePos":3081,"name":"Get","object":null}},"lparen":0,"args":[{"children":[],"start":3085,"end":3103,"code":"\"WWW-Authenticate\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":3085,"kind":9,"value":"\"WWW-Authenticate\""}],"ellipsis":0,"rparen":0}],"ellipsis":0,"rparen":0}}],"rbrace":3106}},{"children":[],"start":3109,"end":3797,"code":"func TestBasicAuth401WithCustomRealm(t *testing.T) {\n\tcalled := false\n\taccounts := Accounts{\"foo\": \"bar\"}\n\trouter := New()\n\trouter.Use(BasicAuthForRealm(accounts, \"My Custom \\\"Realm\\\"\"))\n\trouter.GET(\"/login\", func(c *Context) {\n\t\tcalled = true\n\t\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n\t})\n\tw := httptest.NewRecorder()\n\treq, _ := http.NewRequest(\"GET\", \"/login\", nil)\n\treq.Header.Set(\"Authorization\", \"Basic \"+base64.StdEncoding.EncodeToString([]byte(\"admin:password\")))\n\trouter.ServeHTTP(w, req)\n\tassert.False(t, called)\n\tassert.Equal(t, http.StatusUnauthorized, w.Code)\n\tassert.Equal(t, \"Basic realm=\\\"My Custom \\\\\\\"Realm\\\\\\\"\\\"\", w.Header().Get(\"WWW-Authenticate\"))\n}","nodeType":"FunctionDeclaration","column":0,"line":0,"doc":null,"receiver":null,"name":{"children":[],"start":3114,"end":3145,"code":"TestBasicAuth401WithCustomRealm","nodeType":"Identifier","column":0,"line":0,"namePos":3114,"name":"TestBasicAuth401WithCustomRealm","object":null},"type":{"children":[],"start":3109,"end":3159,"code":"func(t *testing.T)","nodeType":"FunctionType","column":0,"line":0,"Function":3109,"TypeParams":null,"Params":{"children":[],"start":3145,"end":3159,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":3145,"list":[{"children":[],"start":3146,"end":3158,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":3146,"end":3147,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":3146,"name":"t","object":null}],"type":{"children":[],"start":3148,"end":3158,"code":"*testing.T","nodeType":"StarExpression","column":0,"line":0,"star":3148,"expression":{"children":[],"start":3149,"end":3158,"code":"testing.T","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3149,"end":3156,"code":"testing","nodeType":"Identifier","column":0,"line":0,"namePos":3149,"name":"testing","object":null},"sel":{"children":[],"start":3157,"end":3158,"code":"T","nodeType":"Identifier","column":0,"line":0,"namePos":3157,"name":"T","object":null}}},"tag":null,"comment":null}],"closing":3158},"Results":null},"body":{"children":[],"start":3160,"end":3797,"code":"{\n\tcalled := false\n\taccounts := Accounts{\"foo\": \"bar\"}\n\trouter := New()\n\trouter.Use(BasicAuthForRealm(accounts, \"My Custom \\\"Realm\\\"\"))\n\trouter.GET(\"/login\", func(c *Context) {\n\t\tcalled = true\n\t\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n\t})\n\tw := httptest.NewRecorder()\n\treq, _ := http.NewRequest(\"GET\", \"/login\", nil)\n\treq.Header.Set(\"Authorization\", \"Basic \"+base64.StdEncoding.EncodeToString([]byte(\"admin:password\")))\n\trouter.ServeHTTP(w, req)\n\tassert.False(t, called)\n\tassert.Equal(t, http.StatusUnauthorized, w.Code)\n\tassert.Equal(t, \"Basic realm=\\\"My Custom \\\\\\\"Realm\\\\\\\"\\\"\", w.Header().Get(\"WWW-Authenticate\"))\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":3160,"list":[{"children":[],"start":3163,"end":3178,"code":"called := false","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":3163,"end":3169,"code":"called","nodeType":"Identifier","column":0,"line":0,"namePos":3163,"name":"called","object":null}],"tokenPos":3170,"token":47,"rhs":[{"children":[],"start":3173,"end":3178,"code":"false","nodeType":"Identifier","column":0,"line":0,"namePos":3173,"name":"false","object":null}]},{"children":[],"start":3180,"end":3214,"code":"accounts := Accounts{\"foo\": \"bar\"}","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":3180,"end":3188,"code":"accounts","nodeType":"Identifier","column":0,"line":0,"namePos":3180,"name":"accounts","object":null}],"tokenPos":3189,"token":47,"rhs":[{"children":[],"start":3192,"end":3214,"code":"Accounts{\"foo\": \"bar\"}","nodeType":"CompositeLiteral","column":0,"line":0,"type":{"children":[],"start":3192,"end":3200,"code":"Accounts","nodeType":"Identifier","column":0,"line":0,"namePos":3192,"name":"Accounts","object":null},"lbrace":3200,"elements":[{"children":[],"start":3201,"end":3213,"code":"\"foo\": \"bar\"","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":3201,"end":3206,"code":"\"foo\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":3201,"kind":9,"value":"\"foo\""},"colon":0,"value":{"children":[],"start":3208,"end":3213,"code":"\"bar\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":3208,"kind":9,"value":"\"bar\""}}],"rbrace":3213,"incomplete":false}]},{"children":[],"start":3216,"end":3231,"code":"router := New()","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":3216,"end":3222,"code":"router","nodeType":"Identifier","column":0,"line":0,"namePos":3216,"name":"router","object":null}],"tokenPos":3223,"token":47,"rhs":[{"children":[],"start":3226,"end":3231,"code":"New()","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3226,"end":3229,"code":"New","nodeType":"Identifier","column":0,"line":0,"namePos":3226,"name":"New","object":null},"lparen":0,"args":[],"ellipsis":0,"rparen":0}]},{"children":[],"start":3233,"end":3295,"code":"router.Use(BasicAuthForRealm(accounts, \"My Custom \\\"Realm\\\"\"))","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":3233,"end":3295,"code":"router.Use(BasicAuthForRealm(accounts, \"My Custom \\\"Realm\\\"\"))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3233,"end":3243,"code":"router.Use","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3233,"end":3239,"code":"router","nodeType":"Identifier","column":0,"line":0,"namePos":3233,"name":"router","object":null},"sel":{"children":[],"start":3240,"end":3243,"code":"Use","nodeType":"Identifier","column":0,"line":0,"namePos":3240,"name":"Use","object":null}},"lparen":0,"args":[{"children":[],"start":3244,"end":3294,"code":"BasicAuthForRealm(accounts, \"My Custom \\\"Realm\\\"\")","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3244,"end":3261,"code":"BasicAuthForRealm","nodeType":"Identifier","column":0,"line":0,"namePos":3244,"name":"BasicAuthForRealm","object":null},"lparen":0,"args":[{"children":[],"start":3262,"end":3270,"code":"accounts","nodeType":"Identifier","column":0,"line":0,"namePos":3262,"name":"accounts","object":null},{"children":[],"start":3272,"end":3293,"code":"\"My Custom \\\"Realm\\\"\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":3272,"kind":9,"value":"\"My Custom \\\"Realm\\\"\""}],"ellipsis":0,"rparen":0}],"ellipsis":0,"rparen":0}},{"children":[],"start":3297,"end":3415,"code":"router.GET(\"/login\", func(c *Context) {\n\tcalled = true\n\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n})","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":3297,"end":3415,"code":"router.GET(\"/login\", func(c *Context) {\n\tcalled = true\n\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n})","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3297,"end":3307,"code":"router.GET","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3297,"end":3303,"code":"router","nodeType":"Identifier","column":0,"line":0,"namePos":3297,"name":"router","object":null},"sel":{"children":[],"start":3304,"end":3307,"code":"GET","nodeType":"Identifier","column":0,"line":0,"namePos":3304,"name":"GET","object":null}},"lparen":0,"args":[{"children":[],"start":3308,"end":3316,"code":"\"/login\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":3308,"kind":9,"value":"\"/login\""},{"children":[],"start":3318,"end":3414,"code":"func(c *Context) {\n\tcalled = true\n\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n}","nodeType":"FunctionLiteral","column":0,"line":0,"type":{"children":[],"start":3318,"end":3334,"code":"func(c *Context)","nodeType":"FunctionType","column":0,"line":0,"Function":3318,"TypeParams":null,"Params":{"children":[],"start":3322,"end":3334,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":3322,"list":[{"children":[],"start":3323,"end":3333,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":3323,"end":3324,"code":"c","nodeType":"Identifier","column":0,"line":0,"namePos":3323,"name":"c","object":null}],"type":{"children":[],"start":3325,"end":3333,"code":"*Context","nodeType":"StarExpression","column":0,"line":0,"star":3325,"expression":{"children":[],"start":3326,"end":3333,"code":"Context","nodeType":"Identifier","column":0,"line":0,"namePos":3326,"name":"Context","object":null}},"tag":null,"comment":null}],"closing":3333},"Results":null},"body":{"children":[],"start":3335,"end":3414,"code":"{\n\tcalled = true\n\tc.String(http.StatusOK, c.MustGet(AuthUserKey).(string))\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":3335,"list":[{"children":[],"start":3339,"end":3352,"code":"called = true","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":3339,"end":3345,"code":"called","nodeType":"Identifier","column":0,"line":0,"namePos":3339,"name":"called","object":null}],"tokenPos":3346,"token":42,"rhs":[{"children":[],"start":3348,"end":3352,"code":"true","nodeType":"Identifier","column":0,"line":0,"namePos":3348,"name":"true","object":null}]},{"children":[],"start":3355,"end":3411,"code":"c.String(http.StatusOK, c.MustGet(AuthUserKey).(string))","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":3355,"end":3411,"code":"c.String(http.StatusOK, c.MustGet(AuthUserKey).(string))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3355,"end":3363,"code":"c.String","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3355,"end":3356,"code":"c","nodeType":"Identifier","column":0,"line":0,"namePos":3355,"name":"c","object":null},"sel":{"children":[],"start":3357,"end":3363,"code":"String","nodeType":"Identifier","column":0,"line":0,"namePos":3357,"name":"String","object":null}},"lparen":0,"args":[{"children":[],"start":3364,"end":3377,"code":"http.StatusOK","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3364,"end":3368,"code":"http","nodeType":"Identifier","column":0,"line":0,"namePos":3364,"name":"http","object":null},"sel":{"children":[],"start":3369,"end":3377,"code":"StatusOK","nodeType":"Identifier","column":0,"line":0,"namePos":3369,"name":"StatusOK","object":null}},{"children":[],"start":3379,"end":3410,"code":"c.MustGet(AuthUserKey).(string)","nodeType":"TypeAssertExpression","column":0,"line":0,"expression":{"children":[],"start":3379,"end":3401,"code":"c.MustGet(AuthUserKey)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3379,"end":3388,"code":"c.MustGet","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3379,"end":3380,"code":"c","nodeType":"Identifier","column":0,"line":0,"namePos":3379,"name":"c","object":null},"sel":{"children":[],"start":3381,"end":3388,"code":"MustGet","nodeType":"Identifier","column":0,"line":0,"namePos":3381,"name":"MustGet","object":null}},"lparen":0,"args":[{"children":[],"start":3389,"end":3400,"code":"AuthUserKey","nodeType":"Identifier","column":0,"line":0,"namePos":3389,"name":"AuthUserKey","object":null}],"ellipsis":0,"rparen":0},"lparen":3402,"type":{"children":[],"start":3403,"end":3409,"code":"string","nodeType":"Identifier","column":0,"line":0,"namePos":3403,"name":"string","object":null},"rparen":3409}],"ellipsis":0,"rparen":0}}],"rbrace":3413}}],"ellipsis":0,"rparen":0}},{"children":[],"start":3418,"end":3445,"code":"w := httptest.NewRecorder()","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":3418,"end":3419,"code":"w","nodeType":"Identifier","column":0,"line":0,"namePos":3418,"name":"w","object":null}],"tokenPos":3420,"token":47,"rhs":[{"children":[],"start":3423,"end":3445,"code":"httptest.NewRecorder()","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3423,"end":3443,"code":"httptest.NewRecorder","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3423,"end":3431,"code":"httptest","nodeType":"Identifier","column":0,"line":0,"namePos":3423,"name":"httptest","object":null},"sel":{"children":[],"start":3432,"end":3443,"code":"NewRecorder","nodeType":"Identifier","column":0,"line":0,"namePos":3432,"name":"NewRecorder","object":null}},"lparen":0,"args":[],"ellipsis":0,"rparen":0}]},{"children":[],"start":3447,"end":3494,"code":"req, _ := http.NewRequest(\"GET\", \"/login\", nil)","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":3447,"end":3450,"code":"req","nodeType":"Identifier","column":0,"line":0,"namePos":3447,"name":"req","object":null},{"children":[],"start":3452,"end":3453,"code":"_","nodeType":"Identifier","column":0,"line":0,"namePos":3452,"name":"_","object":null}],"tokenPos":3454,"token":47,"rhs":[{"children":[],"start":3457,"end":3494,"code":"http.NewRequest(\"GET\", \"/login\", nil)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3457,"end":3472,"code":"http.NewRequest","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3457,"end":3461,"code":"http","nodeType":"Identifier","column":0,"line":0,"namePos":3457,"name":"http","object":null},"sel":{"children":[],"start":3462,"end":3472,"code":"NewRequest","nodeType":"Identifier","column":0,"line":0,"namePos":3462,"name":"NewRequest","object":null}},"lparen":0,"args":[{"children":[],"start":3473,"end":3478,"code":"\"GET\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":3473,"kind":9,"value":"\"GET\""},{"children":[],"start":3480,"end":3488,"code":"\"/login\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":3480,"kind":9,"value":"\"/login\""},{"children":[],"start":3490,"end":3493,"code":"nil","nodeType":"Identifier","column":0,"line":0,"namePos":3490,"name":"nil","object":null}],"ellipsis":0,"rparen":0}]},{"children":[],"start":3496,"end":3597,"code":"req.Header.Set(\"Authorization\", \"Basic \"+base64.StdEncoding.EncodeToString([]byte(\"admin:password\")))","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":3496,"end":3597,"code":"req.Header.Set(\"Authorization\", \"Basic \"+base64.StdEncoding.EncodeToString([]byte(\"admin:password\")))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3496,"end":3510,"code":"req.Header.Set","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3496,"end":3506,"code":"req.Header","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3496,"end":3499,"code":"req","nodeType":"Identifier","column":0,"line":0,"namePos":3496,"name":"req","object":null},"sel":{"children":[],"start":3500,"end":3506,"code":"Header","nodeType":"Identifier","column":0,"line":0,"namePos":3500,"name":"Header","object":null}},"sel":{"children":[],"start":3507,"end":3510,"code":"Set","nodeType":"Identifier","column":0,"line":0,"namePos":3507,"name":"Set","object":null}},"lparen":0,"args":[{"children":[],"start":3511,"end":3526,"code":"\"Authorization\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":3511,"kind":9,"value":"\"Authorization\""},{"children":[],"start":3528,"end":3596,"code":"\"Basic \" + base64.StdEncoding.EncodeToString([]byte(\"admin:password\"))","nodeType":"BinaryExpression","column":0,"line":0,"leftExpression":{"children":[],"start":3528,"end":3536,"code":"\"Basic \"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":3528,"kind":9,"value":"\"Basic \""},"opPos":3536,"op":12,"rightExpression":{"children":[],"start":3537,"end":3596,"code":"base64.StdEncoding.EncodeToString([]byte(\"admin:password\"))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3537,"end":3570,"code":"base64.StdEncoding.EncodeToString","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3537,"end":3555,"code":"base64.StdEncoding","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3537,"end":3543,"code":"base64","nodeType":"Identifier","column":0,"line":0,"namePos":3537,"name":"base64","object":null},"sel":{"children":[],"start":3544,"end":3555,"code":"StdEncoding","nodeType":"Identifier","column":0,"line":0,"namePos":3544,"name":"StdEncoding","object":null}},"sel":{"children":[],"start":3556,"end":3570,"code":"EncodeToString","nodeType":"Identifier","column":0,"line":0,"namePos":3556,"name":"EncodeToString","object":null}},"lparen":0,"args":[{"children":[],"start":3571,"end":3595,"code":"[]byte(\"admin:password\")","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3571,"end":3577,"code":"[]byte","nodeType":"ArrayType","column":0,"line":0,"leftBracket":3571,"length":null,"element":{"children":[],"start":3573,"end":3577,"code":"byte","nodeType":"Identifier","column":0,"line":0,"namePos":3573,"name":"byte","object":null}},"lparen":0,"args":[{"children":[],"start":3578,"end":3594,"code":"\"admin:password\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":3578,"kind":9,"value":"\"admin:password\""}],"ellipsis":0,"rparen":0}],"ellipsis":0,"rparen":0}}],"ellipsis":0,"rparen":0}},{"children":[],"start":3599,"end":3623,"code":"router.ServeHTTP(w, req)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":3599,"end":3623,"code":"router.ServeHTTP(w, req)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3599,"end":3615,"code":"router.ServeHTTP","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3599,"end":3605,"code":"router","nodeType":"Identifier","column":0,"line":0,"namePos":3599,"name":"router","object":null},"sel":{"children":[],"start":3606,"end":3615,"code":"ServeHTTP","nodeType":"Identifier","column":0,"line":0,"namePos":3606,"name":"ServeHTTP","object":null}},"lparen":0,"args":[{"children":[],"start":3616,"end":3617,"code":"w","nodeType":"Identifier","column":0,"line":0,"namePos":3616,"name":"w","object":null},{"children":[],"start":3619,"end":3622,"code":"req","nodeType":"Identifier","column":0,"line":0,"namePos":3619,"name":"req","object":null}],"ellipsis":0,"rparen":0}},{"children":[],"start":3626,"end":3649,"code":"assert.False(t, called)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":3626,"end":3649,"code":"assert.False(t, called)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3626,"end":3638,"code":"assert.False","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3626,"end":3632,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":3626,"name":"assert","object":null},"sel":{"children":[],"start":3633,"end":3638,"code":"False","nodeType":"Identifier","column":0,"line":0,"namePos":3633,"name":"False","object":null}},"lparen":0,"args":[{"children":[],"start":3639,"end":3640,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":3639,"name":"t","object":null},{"children":[],"start":3642,"end":3648,"code":"called","nodeType":"Identifier","column":0,"line":0,"namePos":3642,"name":"called","object":null}],"ellipsis":0,"rparen":0}},{"children":[],"start":3651,"end":3699,"code":"assert.Equal(t, http.StatusUnauthorized, w.Code)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":3651,"end":3699,"code":"assert.Equal(t, http.StatusUnauthorized, w.Code)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3651,"end":3663,"code":"assert.Equal","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3651,"end":3657,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":3651,"name":"assert","object":null},"sel":{"children":[],"start":3658,"end":3663,"code":"Equal","nodeType":"Identifier","column":0,"line":0,"namePos":3658,"name":"Equal","object":null}},"lparen":0,"args":[{"children":[],"start":3664,"end":3665,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":3664,"name":"t","object":null},{"children":[],"start":3667,"end":3690,"code":"http.StatusUnauthorized","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3667,"end":3671,"code":"http","nodeType":"Identifier","column":0,"line":0,"namePos":3667,"name":"http","object":null},"sel":{"children":[],"start":3672,"end":3690,"code":"StatusUnauthorized","nodeType":"Identifier","column":0,"line":0,"namePos":3672,"name":"StatusUnauthorized","object":null}},{"children":[],"start":3692,"end":3698,"code":"w.Code","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3692,"end":3693,"code":"w","nodeType":"Identifier","column":0,"line":0,"namePos":3692,"name":"w","object":null},"sel":{"children":[],"start":3694,"end":3698,"code":"Code","nodeType":"Identifier","column":0,"line":0,"namePos":3694,"name":"Code","object":null}}],"ellipsis":0,"rparen":0}},{"children":[],"start":3701,"end":3795,"code":"assert.Equal(t, \"Basic realm=\\\"My Custom \\\\\\\"Realm\\\\\\\"\\\"\", w.Header().Get(\"WWW-Authenticate\"))","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":3701,"end":3795,"code":"assert.Equal(t, \"Basic realm=\\\"My Custom \\\\\\\"Realm\\\\\\\"\\\"\", w.Header().Get(\"WWW-Authenticate\"))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3701,"end":3713,"code":"assert.Equal","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3701,"end":3707,"code":"assert","nodeType":"Identifier","column":0,"line":0,"namePos":3701,"name":"assert","object":null},"sel":{"children":[],"start":3708,"end":3713,"code":"Equal","nodeType":"Identifier","column":0,"line":0,"namePos":3708,"name":"Equal","object":null}},"lparen":0,"args":[{"children":[],"start":3714,"end":3715,"code":"t","nodeType":"Identifier","column":0,"line":0,"namePos":3714,"name":"t","object":null},{"children":[],"start":3717,"end":3758,"code":"\"Basic realm=\\\"My Custom \\\\\\\"Realm\\\\\\\"\\\"\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":3717,"kind":9,"value":"\"Basic realm=\\\"My Custom \\\\\\\"Realm\\\\\\\"\\\"\""},{"children":[],"start":3760,"end":3794,"code":"w.Header().Get(\"WWW-Authenticate\")","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3760,"end":3774,"code":"w.Header().Get","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3760,"end":3770,"code":"w.Header()","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":3760,"end":3768,"code":"w.Header","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":3760,"end":3761,"code":"w","nodeType":"Identifier","column":0,"line":0,"namePos":3760,"name":"w","object":null},"sel":{"children":[],"start":3762,"end":3768,"code":"Header","nodeType":"Identifier","column":0,"line":0,"namePos":3762,"name":"Header","object":null}},"lparen":0,"args":[],"ellipsis":0,"rparen":0},"sel":{"children":[],"start":3771,"end":3774,"code":"Get","nodeType":"Identifier","column":0,"line":0,"namePos":3771,"name":"Get","object":null}},"lparen":0,"args":[{"children":[],"start":3775,"end":3793,"code":"\"WWW-Authenticate\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":3775,"kind":9,"value":"\"WWW-Authenticate\""}],"ellipsis":0,"rparen":0}],"ellipsis":0,"rparen":0}}],"rbrace":3796}}],"fileStart":1,"fileEnd":3798,"scope":{"outer":null,"objects":null},"imports":[],"unresolved":[],"comments":[],"goVersion":""}