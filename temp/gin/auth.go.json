{"children":[],"start":168,"end":2804,"code":"package gin\n\nimport (\n\t\"crypto/subtle\"\n\t\"encoding/base64\"\n\t\"net/http\"\n\t\"strconv\"\n\t\"github.com/gin-gonic/gin/internal/bytesconv\"\n)\n\nconst AuthUserKey = \"user\"\n\ntype Accounts map[string]string\ntype authPair struct {\n\tvalue\tstring\n\tuser\tstring\n}\ntype authPairs []authPair\n\nfunc (a authPairs) searchCredential(authValue string) (string, bool) {\n\tif authValue == \"\" {\n\t\treturn \"\", false\n\t}\n\tfor _, pair := range a {\n\t\tif subtle.ConstantTimeCompare(bytesconv.StringToBytes(pair.value), bytesconv.StringToBytes(authValue)) == 1 {\n\t\t\treturn pair.user, true\n\t\t}\n\t}\n\treturn \"\", false\n}\nfunc BasicAuthForRealm(accounts Accounts, realm string) HandlerFunc {\n\tif realm == \"\" {\n\t\trealm = \"Authorization Required\"\n\t}\n\trealm = \"Basic realm=\" + strconv.Quote(realm)\n\tpairs := processAccounts(accounts)\n\treturn func(c *Context) {\n\t\tuser, found := pairs.searchCredential(c.requestHeader(\"Authorization\"))\n\t\tif !found {\n\t\t\tc.Header(\"WWW-Authenticate\", realm)\n\t\t\tc.AbortWithStatus(http.StatusUnauthorized)\n\t\t\treturn\n\t\t}\n\t\tc.Set(AuthUserKey, user)\n\t}\n}\nfunc BasicAuth(accounts Accounts) HandlerFunc {\n\treturn BasicAuthForRealm(accounts, \"\")\n}\nfunc processAccounts(accounts Accounts) authPairs {\n\tlength := len(accounts)\n\tassert1(length \u003e 0, \"Empty list of authorized credentials\")\n\tpairs := make(authPairs, 0, length)\n\tfor user, password := range accounts {\n\t\tassert1(user != \"\", \"User can not be empty\")\n\t\tvalue := authorizationHeader(user, password)\n\t\tpairs = append(pairs, authPair{value: value, user: user})\n\t}\n\treturn pairs\n}\nfunc authorizationHeader(user, password string) string {\n\tbase := user + \":\" + password\n\treturn \"Basic \" + base64.StdEncoding.EncodeToString(bytesconv.StringToBytes(base))\n}\n","nodeType":"File","column":0,"line":0,"doc":null,"package":168,"name":{"children":[],"start":176,"end":179,"code":"gin","nodeType":"Identifier","column":0,"line":0,"namePos":176,"name":"gin","object":null},"declarations":[{"children":[],"start":181,"end":298,"code":"import (\n\t\"crypto/subtle\"\n\t\"encoding/base64\"\n\t\"net/http\"\n\t\"strconv\"\n\t\"github.com/gin-gonic/gin/internal/bytesconv\"\n)","nodeType":"GenericDeclaration","column":0,"line":0,"doc":null,"tokenPosition":181,"token":75,"lparen":188,"specifications":[{"children":[],"start":191,"end":206,"code":"\"crypto/subtle\"","nodeType":"ImportSpecification","column":0,"line":0,"doc":null,"name":null,"path":{"children":[],"start":191,"end":206,"code":"\"crypto/subtle\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":191,"kind":9,"value":"\"crypto/subtle\""},"comment":null,"endPosition":0},{"children":[],"start":208,"end":225,"code":"\"encoding/base64\"","nodeType":"ImportSpecification","column":0,"line":0,"doc":null,"name":null,"path":{"children":[],"start":208,"end":225,"code":"\"encoding/base64\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":208,"kind":9,"value":"\"encoding/base64\""},"comment":null,"endPosition":0},{"children":[],"start":227,"end":237,"code":"\"net/http\"","nodeType":"ImportSpecification","column":0,"line":0,"doc":null,"name":null,"path":{"children":[],"start":227,"end":237,"code":"\"net/http\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":227,"kind":9,"value":"\"net/http\""},"comment":null,"endPosition":0},{"children":[],"start":239,"end":248,"code":"\"strconv\"","nodeType":"ImportSpecification","column":0,"line":0,"doc":null,"name":null,"path":{"children":[],"start":239,"end":248,"code":"\"strconv\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":239,"kind":9,"value":"\"strconv\""},"comment":null,"endPosition":0},{"children":[],"start":251,"end":296,"code":"\"github.com/gin-gonic/gin/internal/bytesconv\"","nodeType":"ImportSpecification","column":0,"line":0,"doc":null,"name":null,"path":{"children":[],"start":251,"end":296,"code":"\"github.com/gin-gonic/gin/internal/bytesconv\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":251,"kind":9,"value":"\"github.com/gin-gonic/gin/internal/bytesconv\""},"comment":null,"endPosition":0}],"rparen":297},{"children":[],"start":369,"end":395,"code":"const AuthUserKey = \"user\"","nodeType":"GenericDeclaration","column":0,"line":0,"doc":null,"tokenPosition":369,"token":64,"lparen":0,"specifications":[{"children":[],"start":375,"end":395,"code":"AuthUserKey = \"user\"","nodeType":"ValueSpecification","column":0,"line":0,"doc":null,"names":[{"children":[],"start":375,"end":386,"code":"AuthUserKey","nodeType":"Identifier","column":0,"line":0,"namePos":375,"name":"AuthUserKey","object":null}],"type":null,"values":[{"children":[],"start":389,"end":395,"code":"\"user\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":389,"kind":9,"value":"\"user\""}],"comment":null}],"rparen":0},{"children":[],"start":470,"end":501,"code":"type Accounts map[string]string","nodeType":"GenericDeclaration","column":0,"line":0,"doc":null,"tokenPosition":470,"token":84,"lparen":0,"specifications":[{"children":[],"start":475,"end":501,"code":"Accounts map[string]string","nodeType":"TypeSpecification","column":0,"line":0,"doc":null,"name":{"children":[],"start":475,"end":483,"code":"Accounts","nodeType":"Identifier","column":0,"line":0,"namePos":475,"name":"Accounts","object":null},"typeParams":null,"assign":0,"type":{"children":[],"start":484,"end":501,"code":"map[string]string","nodeType":"MapType","column":0,"line":0,"map":484,"key":{"children":[],"start":488,"end":494,"code":"string","nodeType":"Identifier","column":0,"line":0,"namePos":488,"name":"string","object":null},"value":{"children":[],"start":495,"end":501,"code":"string","nodeType":"Identifier","column":0,"line":0,"namePos":495,"name":"string","object":null}},"comment":null}],"rparen":0},{"children":[],"start":503,"end":555,"code":"type authPair struct {\n\tvalue\tstring\n\tuser\tstring\n}","nodeType":"GenericDeclaration","column":0,"line":0,"doc":null,"tokenPosition":503,"token":84,"lparen":0,"specifications":[{"children":[],"start":508,"end":555,"code":"authPair struct {\n\tvalue\tstring\n\tuser\tstring\n}","nodeType":"TypeSpecification","column":0,"line":0,"doc":null,"name":{"children":[],"start":508,"end":516,"code":"authPair","nodeType":"Identifier","column":0,"line":0,"namePos":508,"name":"authPair","object":null},"typeParams":null,"assign":0,"type":{"children":[],"start":517,"end":555,"code":"struct {\n\tvalue\tstring\n\tuser\tstring\n}","nodeType":"StructType","column":0,"line":0,"struct":517,"fields":{"children":[],"start":524,"end":555,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":524,"list":[{"children":[],"start":527,"end":539,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":527,"end":532,"code":"value","nodeType":"Identifier","column":0,"line":0,"namePos":527,"name":"value","object":null}],"type":{"children":[],"start":533,"end":539,"code":"string","nodeType":"Identifier","column":0,"line":0,"namePos":533,"name":"string","object":null},"tag":null,"comment":null},{"children":[],"start":541,"end":553,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":541,"end":545,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":541,"name":"user","object":null}],"type":{"children":[],"start":547,"end":553,"code":"string","nodeType":"Identifier","column":0,"line":0,"namePos":547,"name":"string","object":null},"tag":null,"comment":null}],"closing":554},"incomplete":false},"comment":null}],"rparen":0},{"children":[],"start":557,"end":582,"code":"type authPairs []authPair","nodeType":"GenericDeclaration","column":0,"line":0,"doc":null,"tokenPosition":557,"token":84,"lparen":0,"specifications":[{"children":[],"start":562,"end":582,"code":"authPairs []authPair","nodeType":"TypeSpecification","column":0,"line":0,"doc":null,"name":{"children":[],"start":562,"end":571,"code":"authPairs","nodeType":"Identifier","column":0,"line":0,"namePos":562,"name":"authPairs","object":null},"typeParams":null,"assign":0,"type":{"children":[],"start":572,"end":582,"code":"[]authPair","nodeType":"ArrayType","column":0,"line":0,"leftBracket":572,"length":null,"element":{"children":[],"start":574,"end":582,"code":"authPair","nodeType":"Identifier","column":0,"line":0,"namePos":574,"name":"authPair","object":null}},"comment":null}],"rparen":0},{"children":[],"start":584,"end":889,"code":"func (a authPairs) searchCredential(authValue string) (string, bool) {\n\tif authValue == \"\" {\n\t\treturn \"\", false\n\t}\n\tfor _, pair := range a {\n\t\tif subtle.ConstantTimeCompare(bytesconv.StringToBytes(pair.value), bytesconv.StringToBytes(authValue)) == 1 {\n\t\t\treturn pair.user, true\n\t\t}\n\t}\n\treturn \"\", false\n}","nodeType":"FunctionDeclaration","column":0,"line":0,"doc":null,"receiver":{"children":[],"start":589,"end":602,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":589,"list":[{"children":[],"start":590,"end":601,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":590,"end":591,"code":"a","nodeType":"Identifier","column":0,"line":0,"namePos":590,"name":"a","object":null}],"type":{"children":[],"start":592,"end":601,"code":"authPairs","nodeType":"Identifier","column":0,"line":0,"namePos":592,"name":"authPairs","object":null},"tag":null,"comment":null}],"closing":601},"name":{"children":[],"start":603,"end":619,"code":"searchCredential","nodeType":"Identifier","column":0,"line":0,"namePos":603,"name":"searchCredential","object":null},"type":{"children":[],"start":584,"end":652,"code":"func(authValue string) (string, bool)","nodeType":"FunctionType","column":0,"line":0,"Function":584,"TypeParams":null,"Params":{"children":[],"start":619,"end":637,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":619,"list":[{"children":[],"start":620,"end":636,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":620,"end":629,"code":"authValue","nodeType":"Identifier","column":0,"line":0,"namePos":620,"name":"authValue","object":null}],"type":{"children":[],"start":630,"end":636,"code":"string","nodeType":"Identifier","column":0,"line":0,"namePos":630,"name":"string","object":null},"tag":null,"comment":null}],"closing":636},"Results":{"children":[],"start":638,"end":652,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":638,"list":[{"children":[],"start":639,"end":645,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":null,"type":{"children":[],"start":639,"end":645,"code":"string","nodeType":"Identifier","column":0,"line":0,"namePos":639,"name":"string","object":null},"tag":null,"comment":null},{"children":[],"start":647,"end":651,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":null,"type":{"children":[],"start":647,"end":651,"code":"bool","nodeType":"Identifier","column":0,"line":0,"namePos":647,"name":"bool","object":null},"tag":null,"comment":null}],"closing":651}},"body":{"children":[],"start":653,"end":889,"code":"{\n\tif authValue == \"\" {\n\t\treturn \"\", false\n\t}\n\tfor _, pair := range a {\n\t\tif subtle.ConstantTimeCompare(bytesconv.StringToBytes(pair.value), bytesconv.StringToBytes(authValue)) == 1 {\n\t\t\treturn pair.user, true\n\t\t}\n\t}\n\treturn \"\", false\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":653,"list":[{"children":[],"start":656,"end":698,"code":"if authValue == \"\" {\n\treturn \"\", false\n}","nodeType":"IfStatement","column":0,"line":0,"if":656,"initialization":null,"condition":{"children":[],"start":659,"end":674,"code":"authValue == \"\"","nodeType":"BinaryExpression","column":0,"line":0,"leftExpression":{"children":[],"start":659,"end":668,"code":"authValue","nodeType":"Identifier","column":0,"line":0,"namePos":659,"name":"authValue","object":null},"opPos":669,"op":39,"rightExpression":{"children":[],"start":672,"end":674,"code":"\"\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":672,"kind":9,"value":"\"\""}},"body":{"children":[],"start":675,"end":698,"code":"{\n\treturn \"\", false\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":675,"list":[{"children":[],"start":679,"end":695,"code":"return \"\", false","nodeType":"ReturnStatement","column":0,"line":0,"return":679,"results":[{"children":[],"start":686,"end":688,"code":"\"\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":686,"kind":9,"value":"\"\""},{"children":[],"start":690,"end":695,"code":"false","nodeType":"Identifier","column":0,"line":0,"namePos":690,"name":"false","object":null}]}],"rbrace":697},"else":null},{"children":[],"start":700,"end":869,"code":"for _, pair := range a {\n\tif subtle.ConstantTimeCompare(bytesconv.StringToBytes(pair.value), bytesconv.StringToBytes(authValue)) == 1 {\n\t\treturn pair.user, true\n\t}\n}","nodeType":"RangeStatement","column":0,"line":0,"for":700,"key":{"children":[],"start":704,"end":705,"code":"_","nodeType":"Identifier","column":0,"line":0,"namePos":704,"name":"_","object":null},"value":{"children":[],"start":707,"end":711,"code":"pair","nodeType":"Identifier","column":0,"line":0,"namePos":707,"name":"pair","object":null},"tokenPos":712,"token":47,"range":715,"expression":{"children":[],"start":721,"end":722,"code":"a","nodeType":"Identifier","column":0,"line":0,"namePos":721,"name":"a","object":null},"body":{"children":[],"start":723,"end":869,"code":"{\n\tif subtle.ConstantTimeCompare(bytesconv.StringToBytes(pair.value), bytesconv.StringToBytes(authValue)) == 1 {\n\t\treturn pair.user, true\n\t}\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":723,"list":[{"children":[],"start":727,"end":866,"code":"if subtle.ConstantTimeCompare(bytesconv.StringToBytes(pair.value), bytesconv.StringToBytes(authValue)) == 1 {\n\treturn pair.user, true\n}","nodeType":"IfStatement","column":0,"line":0,"if":727,"initialization":null,"condition":{"children":[],"start":730,"end":834,"code":"subtle.ConstantTimeCompare(bytesconv.StringToBytes(pair.value), bytesconv.StringToBytes(authValue)) == 1","nodeType":"BinaryExpression","column":0,"line":0,"leftExpression":{"children":[],"start":730,"end":829,"code":"subtle.ConstantTimeCompare(bytesconv.StringToBytes(pair.value), bytesconv.StringToBytes(authValue))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":730,"end":756,"code":"subtle.ConstantTimeCompare","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":730,"end":736,"code":"subtle","nodeType":"Identifier","column":0,"line":0,"namePos":730,"name":"subtle","object":null},"sel":{"children":[],"start":737,"end":756,"code":"ConstantTimeCompare","nodeType":"Identifier","column":0,"line":0,"namePos":737,"name":"ConstantTimeCompare","object":null}},"lparen":0,"args":[{"children":[],"start":757,"end":792,"code":"bytesconv.StringToBytes(pair.value)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":757,"end":780,"code":"bytesconv.StringToBytes","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":757,"end":766,"code":"bytesconv","nodeType":"Identifier","column":0,"line":0,"namePos":757,"name":"bytesconv","object":null},"sel":{"children":[],"start":767,"end":780,"code":"StringToBytes","nodeType":"Identifier","column":0,"line":0,"namePos":767,"name":"StringToBytes","object":null}},"lparen":0,"args":[{"children":[],"start":781,"end":791,"code":"pair.value","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":781,"end":785,"code":"pair","nodeType":"Identifier","column":0,"line":0,"namePos":781,"name":"pair","object":null},"sel":{"children":[],"start":786,"end":791,"code":"value","nodeType":"Identifier","column":0,"line":0,"namePos":786,"name":"value","object":null}}],"ellipsis":0,"rparen":0},{"children":[],"start":794,"end":828,"code":"bytesconv.StringToBytes(authValue)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":794,"end":817,"code":"bytesconv.StringToBytes","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":794,"end":803,"code":"bytesconv","nodeType":"Identifier","column":0,"line":0,"namePos":794,"name":"bytesconv","object":null},"sel":{"children":[],"start":804,"end":817,"code":"StringToBytes","nodeType":"Identifier","column":0,"line":0,"namePos":804,"name":"StringToBytes","object":null}},"lparen":0,"args":[{"children":[],"start":818,"end":827,"code":"authValue","nodeType":"Identifier","column":0,"line":0,"namePos":818,"name":"authValue","object":null}],"ellipsis":0,"rparen":0}],"ellipsis":0,"rparen":0},"opPos":830,"op":39,"rightExpression":{"children":[],"start":833,"end":834,"code":"1","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":833,"kind":5,"value":"1"}},"body":{"children":[],"start":835,"end":866,"code":"{\n\treturn pair.user, true\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":835,"list":[{"children":[],"start":840,"end":862,"code":"return pair.user, true","nodeType":"ReturnStatement","column":0,"line":0,"return":840,"results":[{"children":[],"start":847,"end":856,"code":"pair.user","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":847,"end":851,"code":"pair","nodeType":"Identifier","column":0,"line":0,"namePos":847,"name":"pair","object":null},"sel":{"children":[],"start":852,"end":856,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":852,"name":"user","object":null}},{"children":[],"start":858,"end":862,"code":"true","nodeType":"Identifier","column":0,"line":0,"namePos":858,"name":"true","object":null}]}],"rbrace":865},"else":null}],"rbrace":868}},{"children":[],"start":871,"end":887,"code":"return \"\", false","nodeType":"ReturnStatement","column":0,"line":0,"return":871,"results":[{"children":[],"start":878,"end":880,"code":"\"\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":878,"kind":9,"value":"\"\""},{"children":[],"start":882,"end":887,"code":"false","nodeType":"Identifier","column":0,"line":0,"namePos":882,"name":"false","object":null}]}],"rbrace":888}},{"children":[],"start":1232,"end":1971,"code":"func BasicAuthForRealm(accounts Accounts, realm string) HandlerFunc {\n\tif realm == \"\" {\n\t\trealm = \"Authorization Required\"\n\t}\n\trealm = \"Basic realm=\" + strconv.Quote(realm)\n\tpairs := processAccounts(accounts)\n\treturn func(c *Context) {\n\t\tuser, found := pairs.searchCredential(c.requestHeader(\"Authorization\"))\n\t\tif !found {\n\t\t\tc.Header(\"WWW-Authenticate\", realm)\n\t\t\tc.AbortWithStatus(http.StatusUnauthorized)\n\t\t\treturn\n\t\t}\n\t\tc.Set(AuthUserKey, user)\n\t}\n}","nodeType":"FunctionDeclaration","column":0,"line":0,"doc":null,"receiver":null,"name":{"children":[],"start":1237,"end":1254,"code":"BasicAuthForRealm","nodeType":"Identifier","column":0,"line":0,"namePos":1237,"name":"BasicAuthForRealm","object":null},"type":{"children":[],"start":1232,"end":1299,"code":"func(accounts Accounts, realm string) HandlerFunc","nodeType":"FunctionType","column":0,"line":0,"Function":1232,"TypeParams":null,"Params":{"children":[],"start":1254,"end":1287,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":1254,"list":[{"children":[],"start":1255,"end":1272,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":1255,"end":1263,"code":"accounts","nodeType":"Identifier","column":0,"line":0,"namePos":1255,"name":"accounts","object":null}],"type":{"children":[],"start":1264,"end":1272,"code":"Accounts","nodeType":"Identifier","column":0,"line":0,"namePos":1264,"name":"Accounts","object":null},"tag":null,"comment":null},{"children":[],"start":1274,"end":1286,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":1274,"end":1279,"code":"realm","nodeType":"Identifier","column":0,"line":0,"namePos":1274,"name":"realm","object":null}],"type":{"children":[],"start":1280,"end":1286,"code":"string","nodeType":"Identifier","column":0,"line":0,"namePos":1280,"name":"string","object":null},"tag":null,"comment":null}],"closing":1286},"Results":{"children":[],"start":1288,"end":1299,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":0,"list":[{"children":[],"start":1288,"end":1299,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":null,"type":{"children":[],"start":1288,"end":1299,"code":"HandlerFunc","nodeType":"Identifier","column":0,"line":0,"namePos":1288,"name":"HandlerFunc","object":null},"tag":null,"comment":null}],"closing":0}},"body":{"children":[],"start":1300,"end":1971,"code":"{\n\tif realm == \"\" {\n\t\trealm = \"Authorization Required\"\n\t}\n\trealm = \"Basic realm=\" + strconv.Quote(realm)\n\tpairs := processAccounts(accounts)\n\treturn func(c *Context) {\n\t\tuser, found := pairs.searchCredential(c.requestHeader(\"Authorization\"))\n\t\tif !found {\n\t\t\tc.Header(\"WWW-Authenticate\", realm)\n\t\t\tc.AbortWithStatus(http.StatusUnauthorized)\n\t\t\treturn\n\t\t}\n\t\tc.Set(AuthUserKey, user)\n\t}\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":1300,"list":[{"children":[],"start":1303,"end":1357,"code":"if realm == \"\" {\n\trealm = \"Authorization Required\"\n}","nodeType":"IfStatement","column":0,"line":0,"if":1303,"initialization":null,"condition":{"children":[],"start":1306,"end":1317,"code":"realm == \"\"","nodeType":"BinaryExpression","column":0,"line":0,"leftExpression":{"children":[],"start":1306,"end":1311,"code":"realm","nodeType":"Identifier","column":0,"line":0,"namePos":1306,"name":"realm","object":null},"opPos":1312,"op":39,"rightExpression":{"children":[],"start":1315,"end":1317,"code":"\"\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1315,"kind":9,"value":"\"\""}},"body":{"children":[],"start":1318,"end":1357,"code":"{\n\trealm = \"Authorization Required\"\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":1318,"list":[{"children":[],"start":1322,"end":1354,"code":"realm = \"Authorization Required\"","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":1322,"end":1327,"code":"realm","nodeType":"Identifier","column":0,"line":0,"namePos":1322,"name":"realm","object":null}],"tokenPos":1328,"token":42,"rhs":[{"children":[],"start":1330,"end":1354,"code":"\"Authorization Required\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1330,"kind":9,"value":"\"Authorization Required\""}]}],"rbrace":1356},"else":null},{"children":[],"start":1359,"end":1404,"code":"realm = \"Basic realm=\" + strconv.Quote(realm)","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":1359,"end":1364,"code":"realm","nodeType":"Identifier","column":0,"line":0,"namePos":1359,"name":"realm","object":null}],"tokenPos":1365,"token":42,"rhs":[{"children":[],"start":1367,"end":1404,"code":"\"Basic realm=\" + strconv.Quote(realm)","nodeType":"BinaryExpression","column":0,"line":0,"leftExpression":{"children":[],"start":1367,"end":1381,"code":"\"Basic realm=\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1367,"kind":9,"value":"\"Basic realm=\""},"opPos":1382,"op":12,"rightExpression":{"children":[],"start":1384,"end":1404,"code":"strconv.Quote(realm)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1384,"end":1397,"code":"strconv.Quote","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1384,"end":1391,"code":"strconv","nodeType":"Identifier","column":0,"line":0,"namePos":1384,"name":"strconv","object":null},"sel":{"children":[],"start":1392,"end":1397,"code":"Quote","nodeType":"Identifier","column":0,"line":0,"namePos":1392,"name":"Quote","object":null}},"lparen":0,"args":[{"children":[],"start":1398,"end":1403,"code":"realm","nodeType":"Identifier","column":0,"line":0,"namePos":1398,"name":"realm","object":null}],"ellipsis":0,"rparen":0}}]},{"children":[],"start":1406,"end":1440,"code":"pairs := processAccounts(accounts)","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":1406,"end":1411,"code":"pairs","nodeType":"Identifier","column":0,"line":0,"namePos":1406,"name":"pairs","object":null}],"tokenPos":1412,"token":47,"rhs":[{"children":[],"start":1415,"end":1440,"code":"processAccounts(accounts)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1415,"end":1430,"code":"processAccounts","nodeType":"Identifier","column":0,"line":0,"namePos":1415,"name":"processAccounts","object":null},"lparen":0,"args":[{"children":[],"start":1431,"end":1439,"code":"accounts","nodeType":"Identifier","column":0,"line":0,"namePos":1431,"name":"accounts","object":null}],"ellipsis":0,"rparen":0}]},{"children":[],"start":1442,"end":1969,"code":"return func(c *Context) {\n\tuser, found := pairs.searchCredential(c.requestHeader(\"Authorization\"))\n\tif !found {\n\t\tc.Header(\"WWW-Authenticate\", realm)\n\t\tc.AbortWithStatus(http.StatusUnauthorized)\n\t\treturn\n\t}\n\tc.Set(AuthUserKey, user)\n}","nodeType":"ReturnStatement","column":0,"line":0,"return":1442,"results":[{"children":[],"start":1449,"end":1969,"code":"func(c *Context) {\n\tuser, found := pairs.searchCredential(c.requestHeader(\"Authorization\"))\n\tif !found {\n\t\tc.Header(\"WWW-Authenticate\", realm)\n\t\tc.AbortWithStatus(http.StatusUnauthorized)\n\t\treturn\n\t}\n\tc.Set(AuthUserKey, user)\n}","nodeType":"FunctionLiteral","column":0,"line":0,"type":{"children":[],"start":1449,"end":1465,"code":"func(c *Context)","nodeType":"FunctionType","column":0,"line":0,"Function":1449,"TypeParams":null,"Params":{"children":[],"start":1453,"end":1465,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":1453,"list":[{"children":[],"start":1454,"end":1464,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":1454,"end":1455,"code":"c","nodeType":"Identifier","column":0,"line":0,"namePos":1454,"name":"c","object":null}],"type":{"children":[],"start":1456,"end":1464,"code":"*Context","nodeType":"StarExpression","column":0,"line":0,"star":1456,"expression":{"children":[],"start":1457,"end":1464,"code":"Context","nodeType":"Identifier","column":0,"line":0,"namePos":1457,"name":"Context","object":null}},"tag":null,"comment":null}],"closing":1464},"Results":null},"body":{"children":[],"start":1466,"end":1969,"code":"{\n\tuser, found := pairs.searchCredential(c.requestHeader(\"Authorization\"))\n\tif !found {\n\t\tc.Header(\"WWW-Authenticate\", realm)\n\t\tc.AbortWithStatus(http.StatusUnauthorized)\n\t\treturn\n\t}\n\tc.Set(AuthUserKey, user)\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":1466,"list":[{"children":[],"start":1523,"end":1594,"code":"user, found := pairs.searchCredential(c.requestHeader(\"Authorization\"))","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":1523,"end":1527,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":1523,"name":"user","object":null},{"children":[],"start":1529,"end":1534,"code":"found","nodeType":"Identifier","column":0,"line":0,"namePos":1529,"name":"found","object":null}],"tokenPos":1535,"token":47,"rhs":[{"children":[],"start":1538,"end":1594,"code":"pairs.searchCredential(c.requestHeader(\"Authorization\"))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1538,"end":1560,"code":"pairs.searchCredential","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1538,"end":1543,"code":"pairs","nodeType":"Identifier","column":0,"line":0,"namePos":1538,"name":"pairs","object":null},"sel":{"children":[],"start":1544,"end":1560,"code":"searchCredential","nodeType":"Identifier","column":0,"line":0,"namePos":1544,"name":"searchCredential","object":null}},"lparen":0,"args":[{"children":[],"start":1561,"end":1593,"code":"c.requestHeader(\"Authorization\")","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1561,"end":1576,"code":"c.requestHeader","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1561,"end":1562,"code":"c","nodeType":"Identifier","column":0,"line":0,"namePos":1561,"name":"c","object":null},"sel":{"children":[],"start":1563,"end":1576,"code":"requestHeader","nodeType":"Identifier","column":0,"line":0,"namePos":1563,"name":"requestHeader","object":null}},"lparen":0,"args":[{"children":[],"start":1577,"end":1592,"code":"\"Authorization\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1577,"kind":9,"value":"\"Authorization\""}],"ellipsis":0,"rparen":0}],"ellipsis":0,"rparen":0}]},{"children":[],"start":1597,"end":1780,"code":"if !found {\n\tc.Header(\"WWW-Authenticate\", realm)\n\tc.AbortWithStatus(http.StatusUnauthorized)\n\treturn\n}","nodeType":"IfStatement","column":0,"line":0,"if":1597,"initialization":null,"condition":{"children":[],"start":1600,"end":1606,"code":"!found","nodeType":"UnaryExpression","column":0,"line":0,"opPos":1600,"op":43,"expression":{"children":[],"start":1601,"end":1606,"code":"found","nodeType":"Identifier","column":0,"line":0,"namePos":1601,"name":"found","object":null}},"body":{"children":[],"start":1607,"end":1780,"code":"{\n\tc.Header(\"WWW-Authenticate\", realm)\n\tc.AbortWithStatus(http.StatusUnauthorized)\n\treturn\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":1607,"list":[{"children":[],"start":1685,"end":1720,"code":"c.Header(\"WWW-Authenticate\", realm)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":1685,"end":1720,"code":"c.Header(\"WWW-Authenticate\", realm)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1685,"end":1693,"code":"c.Header","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1685,"end":1686,"code":"c","nodeType":"Identifier","column":0,"line":0,"namePos":1685,"name":"c","object":null},"sel":{"children":[],"start":1687,"end":1693,"code":"Header","nodeType":"Identifier","column":0,"line":0,"namePos":1687,"name":"Header","object":null}},"lparen":0,"args":[{"children":[],"start":1694,"end":1712,"code":"\"WWW-Authenticate\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":1694,"kind":9,"value":"\"WWW-Authenticate\""},{"children":[],"start":1714,"end":1719,"code":"realm","nodeType":"Identifier","column":0,"line":0,"namePos":1714,"name":"realm","object":null}],"ellipsis":0,"rparen":0}},{"children":[],"start":1724,"end":1766,"code":"c.AbortWithStatus(http.StatusUnauthorized)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":1724,"end":1766,"code":"c.AbortWithStatus(http.StatusUnauthorized)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1724,"end":1741,"code":"c.AbortWithStatus","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1724,"end":1725,"code":"c","nodeType":"Identifier","column":0,"line":0,"namePos":1724,"name":"c","object":null},"sel":{"children":[],"start":1726,"end":1741,"code":"AbortWithStatus","nodeType":"Identifier","column":0,"line":0,"namePos":1726,"name":"AbortWithStatus","object":null}},"lparen":0,"args":[{"children":[],"start":1742,"end":1765,"code":"http.StatusUnauthorized","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1742,"end":1746,"code":"http","nodeType":"Identifier","column":0,"line":0,"namePos":1742,"name":"http","object":null},"sel":{"children":[],"start":1747,"end":1765,"code":"StatusUnauthorized","nodeType":"Identifier","column":0,"line":0,"namePos":1747,"name":"StatusUnauthorized","object":null}}],"ellipsis":0,"rparen":0}},{"children":[],"start":1770,"end":1776,"code":"return","nodeType":"ReturnStatement","column":0,"line":0,"return":1770,"results":[]}],"rbrace":1779},"else":null},{"children":[],"start":1942,"end":1966,"code":"c.Set(AuthUserKey, user)","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":1942,"end":1966,"code":"c.Set(AuthUserKey, user)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":1942,"end":1947,"code":"c.Set","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":1942,"end":1943,"code":"c","nodeType":"Identifier","column":0,"line":0,"namePos":1942,"name":"c","object":null},"sel":{"children":[],"start":1944,"end":1947,"code":"Set","nodeType":"Identifier","column":0,"line":0,"namePos":1944,"name":"Set","object":null}},"lparen":0,"args":[{"children":[],"start":1948,"end":1959,"code":"AuthUserKey","nodeType":"Identifier","column":0,"line":0,"namePos":1948,"name":"AuthUserKey","object":null},{"children":[],"start":1961,"end":1965,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":1961,"name":"user","object":null}],"ellipsis":0,"rparen":0}}],"rbrace":1968}}]}],"rbrace":1970}},{"children":[],"start":2139,"end":2228,"code":"func BasicAuth(accounts Accounts) HandlerFunc {\n\treturn BasicAuthForRealm(accounts, \"\")\n}","nodeType":"FunctionDeclaration","column":0,"line":0,"doc":null,"receiver":null,"name":{"children":[],"start":2144,"end":2153,"code":"BasicAuth","nodeType":"Identifier","column":0,"line":0,"namePos":2144,"name":"BasicAuth","object":null},"type":{"children":[],"start":2139,"end":2184,"code":"func(accounts Accounts) HandlerFunc","nodeType":"FunctionType","column":0,"line":0,"Function":2139,"TypeParams":null,"Params":{"children":[],"start":2153,"end":2172,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":2153,"list":[{"children":[],"start":2154,"end":2171,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":2154,"end":2162,"code":"accounts","nodeType":"Identifier","column":0,"line":0,"namePos":2154,"name":"accounts","object":null}],"type":{"children":[],"start":2163,"end":2171,"code":"Accounts","nodeType":"Identifier","column":0,"line":0,"namePos":2163,"name":"Accounts","object":null},"tag":null,"comment":null}],"closing":2171},"Results":{"children":[],"start":2173,"end":2184,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":0,"list":[{"children":[],"start":2173,"end":2184,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":null,"type":{"children":[],"start":2173,"end":2184,"code":"HandlerFunc","nodeType":"Identifier","column":0,"line":0,"namePos":2173,"name":"HandlerFunc","object":null},"tag":null,"comment":null}],"closing":0}},"body":{"children":[],"start":2185,"end":2228,"code":"{\n\treturn BasicAuthForRealm(accounts, \"\")\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":2185,"list":[{"children":[],"start":2188,"end":2226,"code":"return BasicAuthForRealm(accounts, \"\")","nodeType":"ReturnStatement","column":0,"line":0,"return":2188,"results":[{"children":[],"start":2195,"end":2226,"code":"BasicAuthForRealm(accounts, \"\")","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2195,"end":2212,"code":"BasicAuthForRealm","nodeType":"Identifier","column":0,"line":0,"namePos":2195,"name":"BasicAuthForRealm","object":null},"lparen":0,"args":[{"children":[],"start":2213,"end":2221,"code":"accounts","nodeType":"Identifier","column":0,"line":0,"namePos":2213,"name":"accounts","object":null},{"children":[],"start":2223,"end":2225,"code":"\"\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2223,"kind":9,"value":"\"\""}],"ellipsis":0,"rparen":0}]}],"rbrace":2227}},{"children":[],"start":2230,"end":2629,"code":"func processAccounts(accounts Accounts) authPairs {\n\tlength := len(accounts)\n\tassert1(length \u003e 0, \"Empty list of authorized credentials\")\n\tpairs := make(authPairs, 0, length)\n\tfor user, password := range accounts {\n\t\tassert1(user != \"\", \"User can not be empty\")\n\t\tvalue := authorizationHeader(user, password)\n\t\tpairs = append(pairs, authPair{value: value, user: user})\n\t}\n\treturn pairs\n}","nodeType":"FunctionDeclaration","column":0,"line":0,"doc":null,"receiver":null,"name":{"children":[],"start":2235,"end":2250,"code":"processAccounts","nodeType":"Identifier","column":0,"line":0,"namePos":2235,"name":"processAccounts","object":null},"type":{"children":[],"start":2230,"end":2279,"code":"func(accounts Accounts) authPairs","nodeType":"FunctionType","column":0,"line":0,"Function":2230,"TypeParams":null,"Params":{"children":[],"start":2250,"end":2269,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":2250,"list":[{"children":[],"start":2251,"end":2268,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":2251,"end":2259,"code":"accounts","nodeType":"Identifier","column":0,"line":0,"namePos":2251,"name":"accounts","object":null}],"type":{"children":[],"start":2260,"end":2268,"code":"Accounts","nodeType":"Identifier","column":0,"line":0,"namePos":2260,"name":"Accounts","object":null},"tag":null,"comment":null}],"closing":2268},"Results":{"children":[],"start":2270,"end":2279,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":0,"list":[{"children":[],"start":2270,"end":2279,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":null,"type":{"children":[],"start":2270,"end":2279,"code":"authPairs","nodeType":"Identifier","column":0,"line":0,"namePos":2270,"name":"authPairs","object":null},"tag":null,"comment":null}],"closing":0}},"body":{"children":[],"start":2280,"end":2629,"code":"{\n\tlength := len(accounts)\n\tassert1(length \u003e 0, \"Empty list of authorized credentials\")\n\tpairs := make(authPairs, 0, length)\n\tfor user, password := range accounts {\n\t\tassert1(user != \"\", \"User can not be empty\")\n\t\tvalue := authorizationHeader(user, password)\n\t\tpairs = append(pairs, authPair{value: value, user: user})\n\t}\n\treturn pairs\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":2280,"list":[{"children":[],"start":2283,"end":2306,"code":"length := len(accounts)","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":2283,"end":2289,"code":"length","nodeType":"Identifier","column":0,"line":0,"namePos":2283,"name":"length","object":null}],"tokenPos":2290,"token":47,"rhs":[{"children":[],"start":2293,"end":2306,"code":"len(accounts)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2293,"end":2296,"code":"len","nodeType":"Identifier","column":0,"line":0,"namePos":2293,"name":"len","object":null},"lparen":0,"args":[{"children":[],"start":2297,"end":2305,"code":"accounts","nodeType":"Identifier","column":0,"line":0,"namePos":2297,"name":"accounts","object":null}],"ellipsis":0,"rparen":0}]},{"children":[],"start":2308,"end":2367,"code":"assert1(length \u003e 0, \"Empty list of authorized credentials\")","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":2308,"end":2367,"code":"assert1(length \u003e 0, \"Empty list of authorized credentials\")","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2308,"end":2315,"code":"assert1","nodeType":"Identifier","column":0,"line":0,"namePos":2308,"name":"assert1","object":null},"lparen":0,"args":[{"children":[],"start":2316,"end":2326,"code":"length \u003e 0","nodeType":"BinaryExpression","column":0,"line":0,"leftExpression":{"children":[],"start":2316,"end":2322,"code":"length","nodeType":"Identifier","column":0,"line":0,"namePos":2316,"name":"length","object":null},"opPos":2323,"op":41,"rightExpression":{"children":[],"start":2325,"end":2326,"code":"0","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2325,"kind":5,"value":"0"}},{"children":[],"start":2328,"end":2366,"code":"\"Empty list of authorized credentials\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2328,"kind":9,"value":"\"Empty list of authorized credentials\""}],"ellipsis":0,"rparen":0}},{"children":[],"start":2369,"end":2404,"code":"pairs := make(authPairs, 0, length)","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":2369,"end":2374,"code":"pairs","nodeType":"Identifier","column":0,"line":0,"namePos":2369,"name":"pairs","object":null}],"tokenPos":2375,"token":47,"rhs":[{"children":[],"start":2378,"end":2404,"code":"make(authPairs, 0, length)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2378,"end":2382,"code":"make","nodeType":"Identifier","column":0,"line":0,"namePos":2378,"name":"make","object":null},"lparen":0,"args":[{"children":[],"start":2383,"end":2392,"code":"authPairs","nodeType":"Identifier","column":0,"line":0,"namePos":2383,"name":"authPairs","object":null},{"children":[],"start":2394,"end":2395,"code":"0","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2394,"kind":5,"value":"0"},{"children":[],"start":2397,"end":2403,"code":"length","nodeType":"Identifier","column":0,"line":0,"namePos":2397,"name":"length","object":null}],"ellipsis":0,"rparen":0}]},{"children":[],"start":2406,"end":2613,"code":"for user, password := range accounts {\n\tassert1(user != \"\", \"User can not be empty\")\n\tvalue := authorizationHeader(user, password)\n\tpairs = append(pairs, authPair{value: value, user: user})\n}","nodeType":"RangeStatement","column":0,"line":0,"for":2406,"key":{"children":[],"start":2410,"end":2414,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":2410,"name":"user","object":null},"value":{"children":[],"start":2416,"end":2424,"code":"password","nodeType":"Identifier","column":0,"line":0,"namePos":2416,"name":"password","object":null},"tokenPos":2425,"token":47,"range":2428,"expression":{"children":[],"start":2434,"end":2442,"code":"accounts","nodeType":"Identifier","column":0,"line":0,"namePos":2434,"name":"accounts","object":null},"body":{"children":[],"start":2443,"end":2613,"code":"{\n\tassert1(user != \"\", \"User can not be empty\")\n\tvalue := authorizationHeader(user, password)\n\tpairs = append(pairs, authPair{value: value, user: user})\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":2443,"list":[{"children":[],"start":2447,"end":2491,"code":"assert1(user != \"\", \"User can not be empty\")","nodeType":"ExpressionStatement","column":0,"line":0,"Expression":{"children":[],"start":2447,"end":2491,"code":"assert1(user != \"\", \"User can not be empty\")","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2447,"end":2454,"code":"assert1","nodeType":"Identifier","column":0,"line":0,"namePos":2447,"name":"assert1","object":null},"lparen":0,"args":[{"children":[],"start":2455,"end":2465,"code":"user != \"\"","nodeType":"BinaryExpression","column":0,"line":0,"leftExpression":{"children":[],"start":2455,"end":2459,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":2455,"name":"user","object":null},"opPos":2460,"op":44,"rightExpression":{"children":[],"start":2463,"end":2465,"code":"\"\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2463,"kind":9,"value":"\"\""}},{"children":[],"start":2467,"end":2490,"code":"\"User can not be empty\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2467,"kind":9,"value":"\"User can not be empty\""}],"ellipsis":0,"rparen":0}},{"children":[],"start":2494,"end":2538,"code":"value := authorizationHeader(user, password)","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":2494,"end":2499,"code":"value","nodeType":"Identifier","column":0,"line":0,"namePos":2494,"name":"value","object":null}],"tokenPos":2500,"token":47,"rhs":[{"children":[],"start":2503,"end":2538,"code":"authorizationHeader(user, password)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2503,"end":2522,"code":"authorizationHeader","nodeType":"Identifier","column":0,"line":0,"namePos":2503,"name":"authorizationHeader","object":null},"lparen":0,"args":[{"children":[],"start":2523,"end":2527,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":2523,"name":"user","object":null},{"children":[],"start":2529,"end":2537,"code":"password","nodeType":"Identifier","column":0,"line":0,"namePos":2529,"name":"password","object":null}],"ellipsis":0,"rparen":0}]},{"children":[],"start":2541,"end":2610,"code":"pairs = append(pairs, authPair{value: value, user: user})","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":2541,"end":2546,"code":"pairs","nodeType":"Identifier","column":0,"line":0,"namePos":2541,"name":"pairs","object":null}],"tokenPos":2547,"token":42,"rhs":[{"children":[],"start":2549,"end":2610,"code":"append(pairs, authPair{value: value, user: user})","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2549,"end":2555,"code":"append","nodeType":"Identifier","column":0,"line":0,"namePos":2549,"name":"append","object":null},"lparen":0,"args":[{"children":[],"start":2556,"end":2561,"code":"pairs","nodeType":"Identifier","column":0,"line":0,"namePos":2556,"name":"pairs","object":null},{"children":[],"start":2563,"end":2609,"code":"authPair{value: value, user: user}","nodeType":"CompositeLiteral","column":0,"line":0,"type":{"children":[],"start":2563,"end":2571,"code":"authPair","nodeType":"Identifier","column":0,"line":0,"namePos":2563,"name":"authPair","object":null},"lbrace":2571,"elements":[{"children":[],"start":2576,"end":2588,"code":"value: value","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":2576,"end":2581,"code":"value","nodeType":"Identifier","column":0,"line":0,"namePos":2576,"name":"value","object":null},"colon":0,"value":{"children":[],"start":2583,"end":2588,"code":"value","nodeType":"Identifier","column":0,"line":0,"namePos":2583,"name":"value","object":null}},{"children":[],"start":2593,"end":2604,"code":"user: user","nodeType":"KeyValueExpression","column":0,"line":0,"key":{"children":[],"start":2593,"end":2597,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":2593,"name":"user","object":null},"colon":0,"value":{"children":[],"start":2600,"end":2604,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":2600,"name":"user","object":null}}],"rbrace":2608,"incomplete":false}],"ellipsis":0,"rparen":0}]}],"rbrace":2612}},{"children":[],"start":2615,"end":2627,"code":"return pairs","nodeType":"ReturnStatement","column":0,"line":0,"return":2615,"results":[{"children":[],"start":2622,"end":2627,"code":"pairs","nodeType":"Identifier","column":0,"line":0,"namePos":2622,"name":"pairs","object":null}]}],"rbrace":2628}},{"children":[],"start":2631,"end":2804,"code":"func authorizationHeader(user, password string) string {\n\tbase := user + \":\" + password\n\treturn \"Basic \" + base64.StdEncoding.EncodeToString(bytesconv.StringToBytes(base))\n}","nodeType":"FunctionDeclaration","column":0,"line":0,"doc":null,"receiver":null,"name":{"children":[],"start":2636,"end":2655,"code":"authorizationHeader","nodeType":"Identifier","column":0,"line":0,"namePos":2636,"name":"authorizationHeader","object":null},"type":{"children":[],"start":2631,"end":2685,"code":"func(user, password string) string","nodeType":"FunctionType","column":0,"line":0,"Function":2631,"TypeParams":null,"Params":{"children":[],"start":2655,"end":2678,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":2655,"list":[{"children":[],"start":2656,"end":2677,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":2656,"end":2660,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":2656,"name":"user","object":null},{"children":[],"start":2662,"end":2670,"code":"password","nodeType":"Identifier","column":0,"line":0,"namePos":2662,"name":"password","object":null}],"type":{"children":[],"start":2671,"end":2677,"code":"string","nodeType":"Identifier","column":0,"line":0,"namePos":2671,"name":"string","object":null},"tag":null,"comment":null}],"closing":2677},"Results":{"children":[],"start":2679,"end":2685,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":0,"list":[{"children":[],"start":2679,"end":2685,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":null,"type":{"children":[],"start":2679,"end":2685,"code":"string","nodeType":"Identifier","column":0,"line":0,"namePos":2679,"name":"string","object":null},"tag":null,"comment":null}],"closing":0}},"body":{"children":[],"start":2686,"end":2804,"code":"{\n\tbase := user + \":\" + password\n\treturn \"Basic \" + base64.StdEncoding.EncodeToString(bytesconv.StringToBytes(base))\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":2686,"list":[{"children":[],"start":2689,"end":2718,"code":"base := user + \":\" + password","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":2689,"end":2693,"code":"base","nodeType":"Identifier","column":0,"line":0,"namePos":2689,"name":"base","object":null}],"tokenPos":2694,"token":47,"rhs":[{"children":[],"start":2697,"end":2718,"code":"user + \":\" + password","nodeType":"BinaryExpression","column":0,"line":0,"leftExpression":{"children":[],"start":2697,"end":2707,"code":"user + \":\"","nodeType":"BinaryExpression","column":0,"line":0,"leftExpression":{"children":[],"start":2697,"end":2701,"code":"user","nodeType":"Identifier","column":0,"line":0,"namePos":2697,"name":"user","object":null},"opPos":2702,"op":12,"rightExpression":{"children":[],"start":2704,"end":2707,"code":"\":\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2704,"kind":9,"value":"\":\""}},"opPos":2708,"op":12,"rightExpression":{"children":[],"start":2710,"end":2718,"code":"password","nodeType":"Identifier","column":0,"line":0,"namePos":2710,"name":"password","object":null}}]},{"children":[],"start":2720,"end":2802,"code":"return \"Basic \" + base64.StdEncoding.EncodeToString(bytesconv.StringToBytes(base))","nodeType":"ReturnStatement","column":0,"line":0,"return":2720,"results":[{"children":[],"start":2727,"end":2802,"code":"\"Basic \" + base64.StdEncoding.EncodeToString(bytesconv.StringToBytes(base))","nodeType":"BinaryExpression","column":0,"line":0,"leftExpression":{"children":[],"start":2727,"end":2735,"code":"\"Basic \"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":2727,"kind":9,"value":"\"Basic \""},"opPos":2736,"op":12,"rightExpression":{"children":[],"start":2738,"end":2802,"code":"base64.StdEncoding.EncodeToString(bytesconv.StringToBytes(base))","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2738,"end":2771,"code":"base64.StdEncoding.EncodeToString","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2738,"end":2756,"code":"base64.StdEncoding","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2738,"end":2744,"code":"base64","nodeType":"Identifier","column":0,"line":0,"namePos":2738,"name":"base64","object":null},"sel":{"children":[],"start":2745,"end":2756,"code":"StdEncoding","nodeType":"Identifier","column":0,"line":0,"namePos":2745,"name":"StdEncoding","object":null}},"sel":{"children":[],"start":2757,"end":2771,"code":"EncodeToString","nodeType":"Identifier","column":0,"line":0,"namePos":2757,"name":"EncodeToString","object":null}},"lparen":0,"args":[{"children":[],"start":2772,"end":2801,"code":"bytesconv.StringToBytes(base)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":2772,"end":2795,"code":"bytesconv.StringToBytes","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":2772,"end":2781,"code":"bytesconv","nodeType":"Identifier","column":0,"line":0,"namePos":2772,"name":"bytesconv","object":null},"sel":{"children":[],"start":2782,"end":2795,"code":"StringToBytes","nodeType":"Identifier","column":0,"line":0,"namePos":2782,"name":"StringToBytes","object":null}},"lparen":0,"args":[{"children":[],"start":2796,"end":2800,"code":"base","nodeType":"Identifier","column":0,"line":0,"namePos":2796,"name":"base","object":null}],"ellipsis":0,"rparen":0}],"ellipsis":0,"rparen":0}}]}],"rbrace":2803}}],"fileStart":1,"fileEnd":2805,"scope":{"outer":null,"objects":null},"imports":[],"unresolved":[],"comments":[],"goVersion":""}