{"children":[],"start":168,"end":922,"code":"package binding\n\nimport (\n\t\"errors\"\n\t\"io\"\n\t\"net/http\"\n\t\"google.golang.org/protobuf/proto\"\n)\n\ntype protobufBinding struct{}\n\nfunc (protobufBinding) Name() string {\n\treturn \"protobuf\"\n}\nfunc (b protobufBinding) Bind(req *http.Request, obj any) error {\n\tbuf, err := io.ReadAll(req.Body)\n\tif err != nil {\n\t\treturn err\n\t}\n\treturn b.BindBody(buf, obj)\n}\nfunc (protobufBinding) BindBody(body []byte, obj any) error {\n\tmsg, ok := obj.(proto.Message)\n\tif !ok {\n\t\treturn errors.New(\"obj is not ProtoMessage\")\n\t}\n\tif err := proto.Unmarshal(body, msg); err != nil {\n\t\treturn err\n\t}\n\treturn nil\n}\n","nodeType":"File","column":0,"line":0,"doc":null,"package":168,"name":{"children":[],"start":176,"end":183,"code":"binding","nodeType":"Identifier","column":0,"line":0,"namePos":176,"name":"binding","object":null},"declarations":[{"children":[],"start":185,"end":260,"code":"import (\n\t\"errors\"\n\t\"io\"\n\t\"net/http\"\n\t\"google.golang.org/protobuf/proto\"\n)","nodeType":"GenericDeclaration","column":0,"line":0,"doc":null,"tokenPosition":185,"token":75,"lparen":192,"specifications":[{"children":[],"start":195,"end":203,"code":"\"errors\"","nodeType":"ImportSpecification","column":0,"line":0,"doc":null,"name":null,"path":{"children":[],"start":195,"end":203,"code":"\"errors\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":195,"kind":9,"value":"\"errors\""},"comment":null,"endPosition":0},{"children":[],"start":205,"end":209,"code":"\"io\"","nodeType":"ImportSpecification","column":0,"line":0,"doc":null,"name":null,"path":{"children":[],"start":205,"end":209,"code":"\"io\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":205,"kind":9,"value":"\"io\""},"comment":null,"endPosition":0},{"children":[],"start":211,"end":221,"code":"\"net/http\"","nodeType":"ImportSpecification","column":0,"line":0,"doc":null,"name":null,"path":{"children":[],"start":211,"end":221,"code":"\"net/http\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":211,"kind":9,"value":"\"net/http\""},"comment":null,"endPosition":0},{"children":[],"start":224,"end":258,"code":"\"google.golang.org/protobuf/proto\"","nodeType":"ImportSpecification","column":0,"line":0,"doc":null,"name":null,"path":{"children":[],"start":224,"end":258,"code":"\"google.golang.org/protobuf/proto\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":224,"kind":9,"value":"\"google.golang.org/protobuf/proto\""},"comment":null,"endPosition":0}],"rparen":259},{"children":[],"start":262,"end":291,"code":"type protobufBinding struct{}","nodeType":"GenericDeclaration","column":0,"line":0,"doc":null,"tokenPosition":262,"token":84,"lparen":0,"specifications":[{"children":[],"start":267,"end":291,"code":"protobufBinding struct{}","nodeType":"TypeSpecification","column":0,"line":0,"doc":null,"name":{"children":[],"start":267,"end":282,"code":"protobufBinding","nodeType":"Identifier","column":0,"line":0,"namePos":267,"name":"protobufBinding","object":null},"typeParams":null,"assign":0,"type":{"children":[],"start":283,"end":291,"code":"struct{}","nodeType":"StructType","column":0,"line":0,"struct":283,"fields":{"children":[],"start":289,"end":291,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":289,"list":[],"closing":290},"incomplete":false},"comment":null}],"rparen":0},{"children":[],"start":293,"end":352,"code":"func (protobufBinding) Name() string {\n\treturn \"protobuf\"\n}","nodeType":"FunctionDeclaration","column":0,"line":0,"doc":null,"receiver":{"children":[],"start":298,"end":315,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":298,"list":[{"children":[],"start":299,"end":314,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":null,"type":{"children":[],"start":299,"end":314,"code":"protobufBinding","nodeType":"Identifier","column":0,"line":0,"namePos":299,"name":"protobufBinding","object":null},"tag":null,"comment":null}],"closing":314},"name":{"children":[],"start":316,"end":320,"code":"Name","nodeType":"Identifier","column":0,"line":0,"namePos":316,"name":"Name","object":null},"type":{"children":[],"start":293,"end":329,"code":"func() string","nodeType":"FunctionType","column":0,"line":0,"Function":293,"TypeParams":null,"Params":{"children":[],"start":320,"end":322,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":320,"list":[],"closing":321},"Results":{"children":[],"start":323,"end":329,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":0,"list":[{"children":[],"start":323,"end":329,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":null,"type":{"children":[],"start":323,"end":329,"code":"string","nodeType":"Identifier","column":0,"line":0,"namePos":323,"name":"string","object":null},"tag":null,"comment":null}],"closing":0}},"body":{"children":[],"start":330,"end":352,"code":"{\n\treturn \"protobuf\"\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":330,"list":[{"children":[],"start":333,"end":350,"code":"return \"protobuf\"","nodeType":"ReturnStatement","column":0,"line":0,"return":333,"results":[{"children":[],"start":340,"end":350,"code":"\"protobuf\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":340,"kind":9,"value":"\"protobuf\""}]}],"rbrace":351}},{"children":[],"start":354,"end":517,"code":"func (b protobufBinding) Bind(req *http.Request, obj any) error {\n\tbuf, err := io.ReadAll(req.Body)\n\tif err != nil {\n\t\treturn err\n\t}\n\treturn b.BindBody(buf, obj)\n}","nodeType":"FunctionDeclaration","column":0,"line":0,"doc":null,"receiver":{"children":[],"start":359,"end":378,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":359,"list":[{"children":[],"start":360,"end":377,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":360,"end":361,"code":"b","nodeType":"Identifier","column":0,"line":0,"namePos":360,"name":"b","object":null}],"type":{"children":[],"start":362,"end":377,"code":"protobufBinding","nodeType":"Identifier","column":0,"line":0,"namePos":362,"name":"protobufBinding","object":null},"tag":null,"comment":null}],"closing":377},"name":{"children":[],"start":379,"end":383,"code":"Bind","nodeType":"Identifier","column":0,"line":0,"namePos":379,"name":"Bind","object":null},"type":{"children":[],"start":354,"end":417,"code":"func(req *http.Request, obj any) error","nodeType":"FunctionType","column":0,"line":0,"Function":354,"TypeParams":null,"Params":{"children":[],"start":383,"end":411,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":383,"list":[{"children":[],"start":384,"end":401,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":384,"end":387,"code":"req","nodeType":"Identifier","column":0,"line":0,"namePos":384,"name":"req","object":null}],"type":{"children":[],"start":388,"end":401,"code":"*http.Request","nodeType":"StarExpression","column":0,"line":0,"star":388,"expression":{"children":[],"start":389,"end":401,"code":"http.Request","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":389,"end":393,"code":"http","nodeType":"Identifier","column":0,"line":0,"namePos":389,"name":"http","object":null},"sel":{"children":[],"start":394,"end":401,"code":"Request","nodeType":"Identifier","column":0,"line":0,"namePos":394,"name":"Request","object":null}}},"tag":null,"comment":null},{"children":[],"start":403,"end":410,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":403,"end":406,"code":"obj","nodeType":"Identifier","column":0,"line":0,"namePos":403,"name":"obj","object":null}],"type":{"children":[],"start":407,"end":410,"code":"any","nodeType":"Identifier","column":0,"line":0,"namePos":407,"name":"any","object":null},"tag":null,"comment":null}],"closing":410},"Results":{"children":[],"start":412,"end":417,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":0,"list":[{"children":[],"start":412,"end":417,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":null,"type":{"children":[],"start":412,"end":417,"code":"error","nodeType":"Identifier","column":0,"line":0,"namePos":412,"name":"error","object":null},"tag":null,"comment":null}],"closing":0}},"body":{"children":[],"start":418,"end":517,"code":"{\n\tbuf, err := io.ReadAll(req.Body)\n\tif err != nil {\n\t\treturn err\n\t}\n\treturn b.BindBody(buf, obj)\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":418,"list":[{"children":[],"start":421,"end":453,"code":"buf, err := io.ReadAll(req.Body)","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":421,"end":424,"code":"buf","nodeType":"Identifier","column":0,"line":0,"namePos":421,"name":"buf","object":null},{"children":[],"start":426,"end":429,"code":"err","nodeType":"Identifier","column":0,"line":0,"namePos":426,"name":"err","object":null}],"tokenPos":430,"token":47,"rhs":[{"children":[],"start":433,"end":453,"code":"io.ReadAll(req.Body)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":433,"end":443,"code":"io.ReadAll","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":433,"end":435,"code":"io","nodeType":"Identifier","column":0,"line":0,"namePos":433,"name":"io","object":null},"sel":{"children":[],"start":436,"end":443,"code":"ReadAll","nodeType":"Identifier","column":0,"line":0,"namePos":436,"name":"ReadAll","object":null}},"lparen":0,"args":[{"children":[],"start":444,"end":452,"code":"req.Body","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":444,"end":447,"code":"req","nodeType":"Identifier","column":0,"line":0,"namePos":444,"name":"req","object":null},"sel":{"children":[],"start":448,"end":452,"code":"Body","nodeType":"Identifier","column":0,"line":0,"namePos":448,"name":"Body","object":null}}],"ellipsis":0,"rparen":0}]},{"children":[],"start":455,"end":486,"code":"if err != nil {\n\treturn err\n}","nodeType":"IfStatement","column":0,"line":0,"if":455,"initialization":null,"condition":{"children":[],"start":458,"end":468,"code":"err != nil","nodeType":"BinaryExpression","column":0,"line":0,"leftExpression":{"children":[],"start":458,"end":461,"code":"err","nodeType":"Identifier","column":0,"line":0,"namePos":458,"name":"err","object":null},"opPos":462,"op":44,"rightExpression":{"children":[],"start":465,"end":468,"code":"nil","nodeType":"Identifier","column":0,"line":0,"namePos":465,"name":"nil","object":null}},"body":{"children":[],"start":469,"end":486,"code":"{\n\treturn err\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":469,"list":[{"children":[],"start":473,"end":483,"code":"return err","nodeType":"ReturnStatement","column":0,"line":0,"return":473,"results":[{"children":[],"start":480,"end":483,"code":"err","nodeType":"Identifier","column":0,"line":0,"namePos":480,"name":"err","object":null}]}],"rbrace":485},"else":null},{"children":[],"start":488,"end":515,"code":"return b.BindBody(buf, obj)","nodeType":"ReturnStatement","column":0,"line":0,"return":488,"results":[{"children":[],"start":495,"end":515,"code":"b.BindBody(buf, obj)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":495,"end":505,"code":"b.BindBody","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":495,"end":496,"code":"b","nodeType":"Identifier","column":0,"line":0,"namePos":495,"name":"b","object":null},"sel":{"children":[],"start":497,"end":505,"code":"BindBody","nodeType":"Identifier","column":0,"line":0,"namePos":497,"name":"BindBody","object":null}},"lparen":0,"args":[{"children":[],"start":506,"end":509,"code":"buf","nodeType":"Identifier","column":0,"line":0,"namePos":506,"name":"buf","object":null},{"children":[],"start":511,"end":514,"code":"obj","nodeType":"Identifier","column":0,"line":0,"namePos":511,"name":"obj","object":null}],"ellipsis":0,"rparen":0}]}],"rbrace":516}},{"children":[],"start":519,"end":922,"code":"func (protobufBinding) BindBody(body []byte, obj any) error {\n\tmsg, ok := obj.(proto.Message)\n\tif !ok {\n\t\treturn errors.New(\"obj is not ProtoMessage\")\n\t}\n\tif err := proto.Unmarshal(body, msg); err != nil {\n\t\treturn err\n\t}\n\treturn nil\n}","nodeType":"FunctionDeclaration","column":0,"line":0,"doc":null,"receiver":{"children":[],"start":524,"end":541,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":524,"list":[{"children":[],"start":525,"end":540,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":null,"type":{"children":[],"start":525,"end":540,"code":"protobufBinding","nodeType":"Identifier","column":0,"line":0,"namePos":525,"name":"protobufBinding","object":null},"tag":null,"comment":null}],"closing":540},"name":{"children":[],"start":542,"end":550,"code":"BindBody","nodeType":"Identifier","column":0,"line":0,"namePos":542,"name":"BindBody","object":null},"type":{"children":[],"start":519,"end":578,"code":"func(body []byte, obj any) error","nodeType":"FunctionType","column":0,"line":0,"Function":519,"TypeParams":null,"Params":{"children":[],"start":550,"end":572,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":550,"list":[{"children":[],"start":551,"end":562,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":551,"end":555,"code":"body","nodeType":"Identifier","column":0,"line":0,"namePos":551,"name":"body","object":null}],"type":{"children":[],"start":556,"end":562,"code":"[]byte","nodeType":"ArrayType","column":0,"line":0,"leftBracket":556,"length":null,"element":{"children":[],"start":558,"end":562,"code":"byte","nodeType":"Identifier","column":0,"line":0,"namePos":558,"name":"byte","object":null}},"tag":null,"comment":null},{"children":[],"start":564,"end":571,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":[{"children":[],"start":564,"end":567,"code":"obj","nodeType":"Identifier","column":0,"line":0,"namePos":564,"name":"obj","object":null}],"type":{"children":[],"start":568,"end":571,"code":"any","nodeType":"Identifier","column":0,"line":0,"namePos":568,"name":"any","object":null},"tag":null,"comment":null}],"closing":571},"Results":{"children":[],"start":573,"end":578,"code":"","nodeType":"FieldList","column":0,"line":0,"opening":0,"list":[{"children":[],"start":573,"end":578,"code":"","nodeType":"Field","column":0,"line":0,"doc":null,"names":null,"type":{"children":[],"start":573,"end":578,"code":"error","nodeType":"Identifier","column":0,"line":0,"namePos":573,"name":"error","object":null},"tag":null,"comment":null}],"closing":0}},"body":{"children":[],"start":579,"end":922,"code":"{\n\tmsg, ok := obj.(proto.Message)\n\tif !ok {\n\t\treturn errors.New(\"obj is not ProtoMessage\")\n\t}\n\tif err := proto.Unmarshal(body, msg); err != nil {\n\t\treturn err\n\t}\n\treturn nil\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":579,"list":[{"children":[],"start":582,"end":612,"code":"msg, ok := obj.(proto.Message)","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":582,"end":585,"code":"msg","nodeType":"Identifier","column":0,"line":0,"namePos":582,"name":"msg","object":null},{"children":[],"start":587,"end":589,"code":"ok","nodeType":"Identifier","column":0,"line":0,"namePos":587,"name":"ok","object":null}],"tokenPos":590,"token":47,"rhs":[{"children":[],"start":593,"end":612,"code":"obj.(proto.Message)","nodeType":"TypeAssertExpression","column":0,"line":0,"expression":{"children":[],"start":593,"end":596,"code":"obj","nodeType":"Identifier","column":0,"line":0,"namePos":593,"name":"obj","object":null},"lparen":597,"type":{"children":[],"start":598,"end":611,"code":"proto.Message","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":598,"end":603,"code":"proto","nodeType":"Identifier","column":0,"line":0,"namePos":598,"name":"proto","object":null},"sel":{"children":[],"start":604,"end":611,"code":"Message","nodeType":"Identifier","column":0,"line":0,"namePos":604,"name":"Message","object":null}},"rparen":611}]},{"children":[],"start":614,"end":672,"code":"if !ok {\n\treturn errors.New(\"obj is not ProtoMessage\")\n}","nodeType":"IfStatement","column":0,"line":0,"if":614,"initialization":null,"condition":{"children":[],"start":617,"end":620,"code":"!ok","nodeType":"UnaryExpression","column":0,"line":0,"opPos":617,"op":43,"expression":{"children":[],"start":618,"end":620,"code":"ok","nodeType":"Identifier","column":0,"line":0,"namePos":618,"name":"ok","object":null}},"body":{"children":[],"start":621,"end":672,"code":"{\n\treturn errors.New(\"obj is not ProtoMessage\")\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":621,"list":[{"children":[],"start":625,"end":669,"code":"return errors.New(\"obj is not ProtoMessage\")","nodeType":"ReturnStatement","column":0,"line":0,"return":625,"results":[{"children":[],"start":632,"end":669,"code":"errors.New(\"obj is not ProtoMessage\")","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":632,"end":642,"code":"errors.New","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":632,"end":638,"code":"errors","nodeType":"Identifier","column":0,"line":0,"namePos":632,"name":"errors","object":null},"sel":{"children":[],"start":639,"end":642,"code":"New","nodeType":"Identifier","column":0,"line":0,"namePos":639,"name":"New","object":null}},"lparen":0,"args":[{"children":[],"start":643,"end":668,"code":"\"obj is not ProtoMessage\"","nodeType":"BasicLiteral","column":0,"line":0,"valuePos":643,"kind":9,"value":"\"obj is not ProtoMessage\""}],"ellipsis":0,"rparen":0}]}],"rbrace":671},"else":null},{"children":[],"start":674,"end":740,"code":"if err := proto.Unmarshal(body, msg); err != nil {\n\treturn err\n}","nodeType":"IfStatement","column":0,"line":0,"if":674,"initialization":{"children":[],"start":677,"end":710,"code":"err := proto.Unmarshal(body, msg)","nodeType":"AssignStatement","column":0,"line":0,"lhs":[{"children":[],"start":677,"end":680,"code":"err","nodeType":"Identifier","column":0,"line":0,"namePos":677,"name":"err","object":null}],"tokenPos":681,"token":47,"rhs":[{"children":[],"start":684,"end":710,"code":"proto.Unmarshal(body, msg)","nodeType":"CallExpression","column":0,"line":0,"function":{"children":[],"start":684,"end":699,"code":"proto.Unmarshal","nodeType":"SelectorExpression","column":0,"line":0,"expression":{"children":[],"start":684,"end":689,"code":"proto","nodeType":"Identifier","column":0,"line":0,"namePos":684,"name":"proto","object":null},"sel":{"children":[],"start":690,"end":699,"code":"Unmarshal","nodeType":"Identifier","column":0,"line":0,"namePos":690,"name":"Unmarshal","object":null}},"lparen":0,"args":[{"children":[],"start":700,"end":704,"code":"body","nodeType":"Identifier","column":0,"line":0,"namePos":700,"name":"body","object":null},{"children":[],"start":706,"end":709,"code":"msg","nodeType":"Identifier","column":0,"line":0,"namePos":706,"name":"msg","object":null}],"ellipsis":0,"rparen":0}]},"condition":{"children":[],"start":712,"end":722,"code":"err != nil","nodeType":"BinaryExpression","column":0,"line":0,"leftExpression":{"children":[],"start":712,"end":715,"code":"err","nodeType":"Identifier","column":0,"line":0,"namePos":712,"name":"err","object":null},"opPos":716,"op":44,"rightExpression":{"children":[],"start":719,"end":722,"code":"nil","nodeType":"Identifier","column":0,"line":0,"namePos":719,"name":"nil","object":null}},"body":{"children":[],"start":723,"end":740,"code":"{\n\treturn err\n}","nodeType":"BlockStatement","column":0,"line":0,"lbrace":723,"list":[{"children":[],"start":727,"end":737,"code":"return err","nodeType":"ReturnStatement","column":0,"line":0,"return":727,"results":[{"children":[],"start":734,"end":737,"code":"err","nodeType":"Identifier","column":0,"line":0,"namePos":734,"name":"err","object":null}]}],"rbrace":739},"else":null},{"children":[],"start":885,"end":895,"code":"return nil","nodeType":"ReturnStatement","column":0,"line":0,"return":885,"results":[{"children":[],"start":892,"end":895,"code":"nil","nodeType":"Identifier","column":0,"line":0,"namePos":892,"name":"nil","object":null}]}],"rbrace":921}}],"fileStart":1,"fileEnd":923,"scope":{"outer":null,"objects":null},"imports":[],"unresolved":[],"comments":[],"goVersion":""}